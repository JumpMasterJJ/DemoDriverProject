<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!-- saved from url=(0051)http://blog.csdn.net/lionzl/article/details/7735483 -->
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script async="" src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/alog.mobile.min.js"></script>   
    
    
    <!--AdForward Begin:-->
<script type="text/javascript" async="" src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/ga.js"></script><script type="text/javascript" ads-src="http://csdnim.allyes.com/main/s?user=allyestest|allyestest|allyestest0410&amp;db=csdnim&amp;border=0&amp;local=yes&amp;js=ie" src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/AllyesDeliver.min.js" charset="gbk" id="allyes_ins_22042198" ads-outputs="0" ads-tid="115184ff0_0"></script><style type="text/css"></style><script src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/share.js"></script><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Hover_Arrow {position: absolute; width: 15px; height: 11px; cursor: pointer}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; color: #666666}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_Menu_Close {position: absolute; width: 31px; height: 31px; top: -15px; left: -15px}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><link rel="stylesheet" type="text/css" href="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/job_reco.css"><link href="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/bdsstyle.css" rel="stylesheet" type="text/css"><script type="text/javascript" charset="utf-8" src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/main.js"></script><script charset="utf-8" src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/lightapp.js" data-appid="3629560" async="" name="baidu-tc-cerfication"></script><link rel="stylesheet" type="text/css" href="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/style.css"><link type="text/css" rel="stylesheet" href="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/style(1).css"><script src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/logger.js"></script><script src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/get" async="" type="text/javascript" charset="utf-8"></script><script type="text/javascript" charset="utf-8" src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/helper-utils-moplus-monitor_30b5848.js" _md_="_anymoore_http://apps.bdimg.com/cloudaapi/pkg/helper-utils-moplus-monitor_30b5848.js"></script><script type="text/javascript" charset="utf-8" src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/push-smartBar_6580827.js" _md_="_anymoore_http://apps.bdimg.com/cloudaapi/pkg/push-smartBar_6580827.js"></script><script type="text/javascript" charset="utf-8" src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/app-socialshare_a244e91.js" _md_="_anymoore_http://apps.bdimg.com/cloudaapi/pkg/app-socialshare_a244e91.js"></script><link rel="stylesheet" href="http://bdimg.share.baidu.com/static/api/css/share_style0_16.css?v=8105b07e.css"><script src="http://127.0.0.1:7777/weakBindLight?apikey=zGhG9os6hVZxp2KLek3cwIuM&nonce=ggcloxfeMppRx88tMnId&csrftoken=266ee0ee5aa4db460b209ceb49a3b285&channel=clouda&callback=cloudaPushServiceWeakBindLight"></script><script type="text/javascript" charset="utf-8" src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/account-pay_72c563b.js" _md_="_anymoore_http://apps.bdimg.com/cloudaapi/pkg/account-pay_72c563b.js"></script></head><body class=" hPC" style="padding-bottom: 45px;"><iframe frameborder="0" style="display: none;"></iframe><div id="MathJax_Message" style="display: none;"></div><div id="115184ff0_0" style="padding:0;margin:0;border:0;"><script type="text/javascript" data-belong="allyes" src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/s"></script><script type="text/javascript" data-belong="allyes" src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/delay.min.js"></script><script type="text/javascript" data-belong="allyes" src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/delay.min.js"></script><script type="text/javascript" data-belong="allyes" src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/delay.min.js"></script><script type="text/javascript" data-belong="allyes" src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/delay.min.js"></script><script type="text/javascript" data-belong="allyes" src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/delay.min.js"></script></div>
<!--AdForward End-->

<!--AdForward Begin:-->
<script type="text/javascript" ads-src="http://csdnim.allyes.com/main/s?user=csdn|homepage|floating_1&amp;db=csdnim&amp;border=0&amp;local=yes&amp;js=ie" src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/AllyesDeliver.min.js" charset="gbk" id="allyes_ins_17314814a" ads-outputs="0" ads-tid="1b717f935_0"></script><div id="1b717f935_0" style="padding:0;margin:0;border:0;"><script type="text/javascript" data-belong="allyes" src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/s(1)"></script><script type="text/javascript" data-belong="allyes" src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/delay.min.js"></script><script type="text/javascript" data-belong="allyes" src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/delay.min.js"></script><script type="text/javascript" data-belong="allyes" src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/delay.min.js"></script><script type="text/javascript" data-belong="allyes" src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/delay.min.js"></script><script type="text/javascript" data-belong="allyes" src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/delay.min.js"></script></div>
<!--AdForward End-->

<!--AdForward Begin:-->
<script type="text/javascript" ads-src="http://csdnim.allyes.com/main/s?user=csdn|homepage|WebIM_1&amp;db=csdnim&amp;border=0&amp;local=yes&amp;js=ie" src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/AllyesDeliver.min.js" charset="gbk" id="allyes_ins_215816d83" ads-outputs="0" ads-tid="1511720ec_0"></script><div id="1511720ec_0" style="padding:0;margin:0;border:0;"><script type="text/javascript" data-belong="allyes" src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/s(2)"></script><script type="text/javascript" data-belong="allyes" src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/delay.min.js"></script><script type="text/javascript" data-belong="allyes" src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/delay.min.js"></script><script type="text/javascript" data-belong="allyes" src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/delay.min.js"></script><script type="text/javascript" data-belong="allyes" src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/delay.min.js"></script><script type="text/javascript" data-belong="allyes" src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/delay.min.js"></script></div>
<!--AdForward End-->

     
    <script type="text/javascript" src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/tracking.js" charset="utf-8"></script>  

    <script type="text/javascript">
        var protocol = window.location.protocol;
        document.write('<script type="text/javascript" src="' + protocol + '//csdnimg.cn/pubfooter/js/repoAddr2.js?v=' + Math.random() + '"></' + 'script>');
    </script><script type="text/javascript" src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/repoAddr2.js"></script>

     <script id="allmobilize" charset="utf-8" src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/allmobilize.min.js"></script>
 <meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" media="handheld" href="http://blog.csdn.net/lionzl/article/details/7735483#">

    <title>Hook Shadow SSDT - lionzl的专栏
        - 博客频道 - CSDN.NET</title>
    
    <meta name="description" content="網上很多文章都有關於SSDT的完整的實現，但是沒有關於Shadow SSDT的完整實現，目前最好的文章是《shadow ssdt學習筆記 by zhuwg》，我這裡的程式也很多參考了他的文章，在這裡謝謝了。我這裡給出一個hook shadow ssdt的完整實現的驅動和3層的代碼。這裡主要是hook 了NtUserFindWindowEx，NtUserBuildHwndList，NtUse">
    <script src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/jquery.js" type="text/javascript"></script>
    <script type="text/javascript" src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/ad.js"></script>
        <!--new top-->
       
        <link rel="stylesheet" href="http://static.csdn.net/public/common/toolbar/css/index.css">
        <!--new top-->

    <link rel="Stylesheet" type="text/css" href="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/style(2).css">
    <link id="RSSLink" title="RSS" type="application/rss+xml" rel="alternate" href="http://blog.csdn.net/lionzl/rss/list">
    <link rel="shortcut icon" href="http://c.csdnimg.cn/public/favicon.ico">
    <link type="text/css" rel="stylesheet" href="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/default.css">
 




    
   
      <!--new top-->
    <script id="toolbar-tpl-scriptId" fixed="true" prod="blog" skin="black" src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/html.js" type="text/javascript"></script><div class="csdn-toolbar csdn-toolbar-skin-black ">        <div class="container row center-block ">          <div class="col-md-3 pull-left logo clearfix"><a href="http://www.csdn.net/?ref=toolbar" title="CSDN首页" target="_blank" class="icon"></a><a title="频道首页" href="http://blog.csdn.net/?ref=toolbar_logo" target="_blank" class="img blog-icon"></a></div>          <div class="pull-right login-wrap unlogin">            <ul class="btns">              <li class="loginlink"><a href="https://passport.csdn.net/account/login?ref=toolbar" target="_top">登录&nbsp;</a>|<a target="_top" href="https://passport.csdn.net/account/register?ref=toolbar">&nbsp;注册</a></li>              <li class="search">                <div class="icon on-search-icon">                  <div class="wrap">                    <div class="curr-icon-wrap">                      <div class="curr-icon"></div>                    </div>                    <form action="http://so.csdn.net/search" method="get" target="_blank">                      <input type="hidden" value="toolbar" name="ref" accesskey="2">                      <div class="border">                        <input placeholder="搜索" type="text" value="" name="q" accesskey="2"><span class="icon-enter-sm"></span>                      </div>                    </form>                  </div>                </div>              </li>              <li class="favor">                <div class="icon on-favor-icon">                  <div class="wrap">                    <div class="curr-icon-wrap">                      <div class="curr-icon"></div>                    </div>                    <div style="display:none;" class="favor-success"><span class="msg">收藏成功</span>                      <div class="btns"><span class="btn btn-primary ok">确定</span></div>                    </div>                    <div style="display:none;" class="favor-failed"><span class="icon-danger-lg"></span><span class="msg">收藏失败，请重新收藏</span>                      <div class="btns"><span class="btn btn-primary ok">确定</span></div>                    </div>                    <form role="form" class="form-horizontal favor-form">                      <div class="form-group">                        <div class="clearfix">                          <label for="input-title" class="col-sm-2 control-label">标题</label>                          <div class="col-sm-10">                            <input id="inputTitle" type="text" placeholder="" class="title form-control">                          </div>                        </div>                        <div class="alert alert-danger"><strong></strong>标题不能为空</div>                      </div>                      <div class="form-group">                        <label for="input-url" class="col-sm-2 control-label">网址</label>                        <div class="col-sm-10">                          <input id="input-url" type="text" placeholder="" class="url form-control">                        </div>                      </div>                      <div class="form-group">                        <label for="input-tag" class="col-sm-2 tag control-label">标签</label>                        <div class="col-sm-10">                          <input id="input-tag" type="text" class="form-control tag">                        </div>                      </div>                      <div class="form-group">                        <label for="input-description" class="description col-sm-2 control-label">摘要</label>                        <div class="col-sm-10">                          <textarea id="input-description" class="form-control description"></textarea>                        </div>                      </div>                      <div class="form-group">                        <div class="col-sm-offset-2 col-sm-10 ft">                          <div class="col-sm-4 pull-left">                            <div class="checkbox">                              <label>                                <input type="checkbox" name="share" checked="checked" class="share">公开                              </label>                            </div>                          </div>                          <div class="col-sm-8 pull-right favor-btns">                            <button type="button" class="cancel btn btn-default">取消</button>                            <button type="submit" class="submit btn btn-primary">收藏</button>                          </div>                        </div>                      </div>                    </form>                  </div>                </div>              </li>              <li class="notify">                <div style="display:none" class="number"></div>                <div style="display:none" class="icon-hasnotes-sm"></div>                <div id="header_notice_num"></div>                <div class="icon on-notify-icon">                  <div class="wrap">                    <div class="curr-icon-wrap">                      <div class="curr-icon"></div>                    </div>                    <div id="note1" class="csdn_note">                      <div class="box"></div>                    <iframe src="about:block" frameborder="0" allowtransparency="true" style="z-index:-1;position:absolute;top:0;left:0;width:100%;height:100%;background:transparent"></iframe></div>                  </div>                </div>              </li>              <li class="ugc">                <div class="icon on-ugc-icon">                  <div class="wrap clearfix">                    <div class="curr-icon-wrap">                      <div class="curr-icon"></div>                    </div>                    <dl>                      <dt><a href="http://geek.csdn.net/news/expert?ref=toolbar" target="_blank" class="p-news clearfix"><em class="icon"></em><span>分享资讯</span></a></dt>                      <dt><a href="http://share.csdn.net/slides/new?ref=toolbar" target="_blank" class="p-doc clearfix"><em class="icon"></em><span>传PPT/文档</span></a></dt>                      <dt><a href="http://bbs.csdn.net/topics/new?ref=toolbar" target="_blank" class="p-ask clearfix"><em class="icon"></em><span>提问题</span></a></dt>                      <dt><a href="http://write.blog.csdn.net/postedit?ref=toolbar" target="_blank" class="p-blog clearfix"><em class="icon"></em><span>写博客</span></a></dt>                      <dt><a href="http://u.download.csdn.net/upload?ref=toolbar" target="_blank" class="p-src clearfix"><em class="icon"></em><span>传资源</span></a></dt>                      <dt><a href="https://code.csdn.net/projects/new?ref=toolbar" target="_blank" class="c-obj clearfix"><em class="icon"></em><span>创建项目</span></a></dt>                      <dt><a href="https://code.csdn.net/snippets/new?ref=toolbar" target="_blank" class="c-code clearfix"><em class="icon"></em><span>创建代码片</span></a></dt>                    </dl>                  </div>                </div>              </li>              <li class="profile">                <div class="icon on-profile-icon"><img src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/100x100.jpg" class="curr-icon-img">                  <div class="wrap clearfix">                    <div class="curr-icon-wrap">                      <div class="curr-icon"></div>                    </div>                    <div class="bd">                      <dl class="clearfix">                        <dt class="pull-left img"><a target="_blank" href="http://my.csdn.net/?ref=toolbar" class="avatar"><img src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/100x100.jpg"></a></dt>                        <dd class="info" style="border: none;"><a target="_blank" href="http://my.csdn.net/?ref=toolbar" class="nickname"></a><a class="set-nick" href="https://passport.csdn.net/account/profile">设置昵称<span class="write-icon"></span></a><span class="dec"><a class="fill-dec" href="http://my.csdn.net/" target="_blank">编辑自我介绍，让更多人了解你<span class="write-icon"></span></a></span></dd>                      </dl>                    </div>                    <div class="ft clearfix"><a target="_blank" href="http://my.csdn.net/my/account/changepwd?ref=toolbar" class="pull-left"><span class="icon-cog"></span>帐号设置</a><a href="https://passport.csdn.net/account/logout?ref=toolbar" target="_top" class="pull-left" style="margin-left:132px; width:18px; height:27px; white-space:nowrap; overflow:hidden;"><span class="icon-signout"></span><span class="out">退出</span></a></div>                  </div>                </div>              </li>              <li class="apps">                <div id="chasnew123" class="hasnew" style="display: none;"></div>                <div id="cappsarea123" class="icon on-apps-icon">                  <div class="wrap clearfix">                    <div class="curr-icon-wrap">                      <div class="curr-icon"></div>                    </div>                  <div class="detail">                    <dl>                      <dt>                        <h5>社区</h5>                      </dt>                      <dd> <a href="http://blog.csdn.net/?ref=toolbar" target="_blank">博客</a></dd>                      <dd> <a href="http://bbs.csdn.net/?ref=toolbar" target="_blank">论坛</a></dd>                      <dd> <a href="http://download.csdn.net/?ref=toolbar" target="_blank">下载</a></dd>                      <dd><a href="http://ask.csdn.net/?ref=toolbar" target="_blank">技术问答</a></dd>                      <dd><a href="http://geek.csdn.net/?ref=toolbar" target="_blank">极客头条</a></dd>                      <dd> <a href="http://hero.csdn.net/?ref=toolbar" target="_blank">英雄会</a></dd>                    </dl>                  </div>                  <div class="detail">                    <dl>                      <dt>                        <h5>服务</h5>                      </dt>                      <dd> <a href="http://job.csdn.net/?ref=toolbar" target="_blank">JOB<img src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/new.gif" style="display: none; margin-top: -26px; width: 23px;"></a></dd>                      <dd> <a href="http://edu.csdn.net/?ref=toolbar" target="_blank">学院<img src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/new.gif" style="display: none; margin-top: -26px; width: 23px;"></a></dd>                      <dd> <a href="https://code.csdn.net/?ref=toolbar" target="_blank">CODE</a></dd>                      <dd> <a href="http://huiyi.csdn.net/?ref=toolbar" target="_blank">活动</a></dd>                      <dd> <a href="http://www.csto.com/?ref=toolbar" target="_blank">CSTO</a></dd>                      <dd> <a href="http://mall.csdn.net/?ref=toolbar" target="_blank">C币兑换<img src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/new.gif" style="display: none; margin-top: -26px; width: 23px;"></a></dd>                    </dl>                  </div>                  <div class="detail last">                    <dl>                      <dt>                        <h5>俱乐部</h5>                      </dt>                      <dd> <a href="http://cto.csdn.net/?ref=toolbar" target="_blank">CTO俱乐部</a></dd>                      <dd> <a href="http://student.csdn.net/?ref=toolbar" target="_blank">高校俱乐部</a></dd>                    </dl>                  </div>                </div>              </div>            </li>            </ul>          </div>        </div>    </div>
     <!--new top-->
    <div id="container">
        <div id="header">
    <div class="header">
        <div id="blog_title">
            <h2>
                <a href="http://blog.csdn.net/lionzl">lionzl的专栏</a></h2>
            <h3></h3>
            <div class="clear">
            </div>
        </div>
        <div class="clear">
        </div>
    </div>
</div>
<div id="navigator">
    <div class="navigator_bg">
    </div>
    <div class="navigator">
        <ul>
            
                <li id="btnContents"><a href="http://blog.csdn.net/lionzl?viewmode=contents"><span onclick="_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_mulu&#39;])">
                    <img src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/ico_list.gif">目录视图</span></a></li>
                <li id="btnView"><a href="http://blog.csdn.net/lionzl?viewmode=list"><span onclick="_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_zhaiyao&#39;])">
                    <img src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/ico_summary.gif">摘要视图</span></a></li>
                <li id="btnRss"><a href="http://blog.csdn.net/lionzl/rss/list"><span onclick="_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_RSS&#39;])">
                    <img src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/ico_rss.gif">订阅</span></a></li>                

            </ul>
    </div>
</div>
<script type="text/javascript">
    var username = "lionzl";
    var _blogger = username;
    var blog_address = "http://blog.csdn.net/lionzl";
    var static_host = "http://static.blog.csdn.net";
    var currentUserName = "";  
</script>

        <div id="body">
            <div id="main">
                <div class="main">
                        <div class="ad_class">
<div class="notice tracking-ad" data-mod="popu_3"> 

<a href="http://vote.blog.csdn.net/">
<font color="red">Markdown那么好，你不想试试？
</font></a>
&nbsp;&nbsp;&nbsp;

<a href="http://bbs.csdn.net/topics/391008139">
<font color="blue">天天爱答题 一大波C币袭来
</font></a>
&nbsp;&nbsp;&nbsp;


<a href="http://www.csdn.net/article/2015-04-22/2824535-Java">
<font color="red">寻找Java大牛！</font></a>
&nbsp;&nbsp;&nbsp;


<a href="http://bss.csdn.net/m/topic/edu_exam">
<font color="blue">一次拿下软考，自有锦囊妙计！</font></a>
&nbsp;&nbsp;&nbsp;


</div>                        </div>
                        

  
<link href="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/comment1.css" type="text/css" rel="stylesheet">
<link href="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/style1.css" type="text/css" rel="stylesheet">
<script language="JavaScript" type="text/javascript" src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/jquery.cookie.js"></script>
<script type="text/javascript" src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/main(1).js"></script>


<link rel="stylesheet" href="http://static.blog.csdn.net/public/res-min/markdown_views.css?v=1.0">

<script type="text/javascript" src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/MathJax.js"></script>









  <script type="text/ecmascript">
      window.quickReplyflag = true;
    </script>
<div id="article_details" class="details">
    <div class="article_title">   
         <span class="ico ico_type_Repost"></span>


    <h1>
        <span class="link_title"><a href="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET.htm">
        Hook Shadow SSDT
        </a></span>
    </h1>
</div>

    <div class="article_manage">
        <span class="link_categories">
        分类：
            <a href="http://blog.csdn.net/lionzl/article/category/720391" onclick="_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_fenlei&#39;]);">计算机安全</a> 
        </span>
    <span class="link_postdate">2012-07-11 10:35</span>
    <span class="link_view" title="阅读次数">242人阅读</span>
    <span class="link_comments" title="评论次数"><a href="http://blog.csdn.net/lionzl/article/details/7735483#comments" onclick="_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_pinglun&#39;])">评论</a>(0)</span>
    <span class="link_collect"><a href="javascript:void(0);" onclick="javascript:_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_shoucang&#39;]);collectArticle(&#39;Hook Shadow SSDT&#39;,&#39;7735483&#39;);return false;" title="收藏">收藏</a></span>
    <span class="link_report"><a href="http://blog.csdn.net/lionzl/article/details/7735483#report" onclick="javascript:_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_jubao&#39;]);report(7735483,2);return false;" title="举报">举报</a></span>
    
</div>
<div class="tag2box"><a href="http://www.csdn.net/tag/hook" target="_blank" onclick="_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_tag&#39;]);">hook</a><a href="http://www.csdn.net/tag/string" target="_blank" onclick="_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_tag&#39;]);">string</a><a href="http://www.csdn.net/tag/object" target="_blank" onclick="_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_tag&#39;]);">object</a><a href="http://www.csdn.net/tag/null" target="_blank" onclick="_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_tag&#39;]);">null</a><a href="http://www.csdn.net/tag/windows" target="_blank" onclick="_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_tag&#39;]);">windows</a><a href="http://www.csdn.net/tag/attributes" target="_blank" onclick="_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_tag&#39;]);">attributes</a></div>

  
    
<div id="article_content" class="article_content">

<div class="article-content">
<p style="margin-bottom:12pt"><span style="font-size:24px; color:#000000"><span>網上很多文章都有關於</span><span lang="EN-US">SSDT</span>的完整的實現，但是沒有關於</span><span lang="EN-US">Shadow&nbsp;SSDT</span><span style="">的完整實現，目前最好的文章是《</span><span lang="EN-US">shadow&nbsp;ssdt</span><span>學習筆記</span><span lang="EN-US">&nbsp;by&nbsp;zhuwg</span><span>》，我這裡的程式也很多參考了他的文章，在這裡謝謝了。我這裡給出一個</span><span style="">hook&nbsp;shadow&nbsp;ssdt</span><span>的完整實現的驅動和</span><span lang="EN-US">3</span><span>層的代碼。</span><span lang="EN-US"><br>
<br>
</span><span style="font-size:7.5pt">這裡主要是</span><span lang="EN-US" style="font-size:7.5pt">hook&nbsp;</span><span style="font-size:7.5pt">了</span><span lang="EN-US" style="font-size:7.5pt">NtUserFindWindowEx</span><span style="font-size:7.5pt">，</span><span lang="EN-US" style="font-size:7.5pt">NtUserBuildHwndList</span><span style="font-size:7.5pt">，</span><span lang="EN-US" style="font-size:7.5pt">NtUserQueryWindow</span><span style="font-size:7.5pt">，</span><span lang="EN-US" style="font-size:7.5pt">NtUserGetForegroundWindow</span><span style="font-size:7.5pt">，</span><span lang="EN-US" style="font-size:7.5pt">NtUserWindowFromPoint</span><span style="font-size:7.5pt">來防止其他應用程式通過</span><span lang="EN-US" style="font-size:7.5pt">FindWindow</span><span style="font-size:7.5pt">，</span><span lang="EN-US" style="font-size:7.5pt">EnumWindow</span><span style="font-size:7.5pt">，</span><span lang="EN-US" style="font-size:7.5pt">WindowFromPoint</span><span style="font-size:7.5pt">，</span><span lang="EN-US" style="font-size:7.5pt">GetForegroundWindow</span><span style="font-size:7.5pt">這些函數來枚舉我們的視窗，不過這個程式對於</span><span lang="EN-US" style="font-size:7.5pt">GetWindowText</span><span style="font-size:7.5pt">這個東西無法防護，如果有朋友在驅動層實現了對該函數的保護，是否能一起交流呢。</span><span lang="EN-US" style="font-size:7.5pt"><br>
<br>
</span><span style="font-size:7.5pt">關於</span><span lang="EN-US" style="font-size:7.5pt">hook</span><span style="font-size:7.5pt">的流程，看了上面</span><span lang="EN-US" style="font-size:7.5pt">zhuwg</span><span style="font-size:7.5pt">的文章，大家應該很好的瞭解了。下面的代碼也很簡單。大家隨便看看吧，通信方面，隨便使用了</span><span lang="EN-US" style="font-size:7.5pt">METHOD_NEITHER</span><span style="font-size:7.5pt">方法，這個方法不好，有問題，不過懶得改了，懂驅動的應該很容易改為</span><span lang="EN-US" style="font-size:7.5pt">BUFFERED</span><span style="font-size:7.5pt">模式吧。</span><span lang="EN-US" style="font-size:7.5pt"><br>
<br>
</span><span style="font-size:7.5pt">在這裡謝謝給了很多幫助的各位牛人，特別是</span><span lang="EN-US" style="font-size:7.5pt">NetRoc</span><span style="font-size:7.5pt">，很細心的幫我測試。。</span></p>
<p><span style="font-size:24px; color:#000000"><span style="font-size:7.5pt">代碼</span><span lang="EN-US" style="font-size:7.5pt">:</span></span></p>
<p><span lang="EN-US" style="font-family:細明體; color:blue">#include</span><span lang="EN-US" style="font-family:細明體">
<span style="color:#a31515">&lt;ntddk.h&gt;</span></span></p>
<p><span lang="EN-US" style="font-family:細明體; color:blue">#include</span><span lang="EN-US" style="font-family:細明體">
<span style="color:#a31515">&lt;windef.h&gt;</span></span></p>
<p><span lang="EN-US" style="font-family:細明體; color:blue">#include</span><span lang="EN-US" style="font-family:細明體">
<span style="color:#a31515">&lt;stdio.h&gt;</span></span></p>
<p><span lang="EN-US" style="font-family:細明體; color:blue">#include</span><span lang="EN-US" style="font-family:細明體">
<span style="color:#a31515">&lt;string.h&gt;</span></span></p>
<p><span lang="EN-US" style="font-family:細明體; color:blue">#include</span><span lang="EN-US" style="font-family:細明體">
<span style="color:#a31515">"HookShadowSSDT.h"</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span style="color:#000000"><span lang="EN-US">VOID</span><span lang="EN-US"> UnloadDriver(INPDRIVER_OBJECT DriverObject);</span></span></p>
<p><span style="color:#000000"><span lang="EN-US">NTSTATUS</span><span lang="EN-US">&nbsp; HideProcess_Create(IN PDEVICE_OBJECTDeviceObject, INPIRP Irp);</span></span></p>
<p><span style="color:#000000"><span lang="EN-US">NTSTATUS</span><span lang="EN-US">&nbsp; HideProcess_Close(IN PDEVICE_OBJECTDeviceObject, INPIRP Irp);</span></span></p>
<p><span style="color:#000000"><span lang="EN-US">NTSTATUS</span><span lang="EN-US">&nbsp; HideProcess_IoControl(IN PDEVICE_OBJECTDeviceObject, INPIRP Irp);</span></span></p>
<p><span style="color:#000000"><span lang="EN-US">PVOID</span><span lang="EN-US"> GetInfoTable(ULONGATableType);</span></span></p>
<p><span style="color:#000000"><span lang="EN-US">HANDLE</span><span lang="EN-US"> GetCsrPid();</span></span></p>
<p><span style="color:#000000"><span lang="EN-US">VOID</span><span lang="EN-US"> InitCallNumber();</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span style="color:#000000"><span lang="EN-US">NTSTATUS</span><span lang="EN-US"> PsLookupProcessByProcessId(IN ULONG ulProcId, OUT PEPROCESS * pEProcess);</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span style="color:#000000"><span lang="EN-US">///////////////</span>聲明NativeAPI///////////////////////////////////////</span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span style="color:#000000"><span lang="EN-US">typedef</span><span lang="EN-US"> NTSTATUS (*NTUSERFINDWINDOWEX)(</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; IN HWND hwndParent,</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; IN HWND hwndChild,</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; IN PUNICODE_STRING pstrClassNameOPTIONAL,
</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; IN PUNICODE_STRING pstrWindowNameOPTIONAL,
</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; IN DWORD dwType);</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span style="color:#000000"><span lang="EN-US">typedef</span><span lang="EN-US"> NTSTATUS (*NTUSERBUILDHWNDLIST)(</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IN HDESK hdesk,</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IN HWND hwndNext,
</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IN ULONG fEnumChildren,
</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IN DWORD idThread,
</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IN UINT cHwndMax,
</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OUT HWND *phwndFirst,
</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OUT ULONG *pcHwndNeeded);</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span style="color:#000000"><span lang="EN-US">typedef</span><span lang="EN-US"> UINT_PTR (*NTUSERQUERYWINDOW)(</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; IN ULONG WindowHandle,</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; IN ULONG TypeInformation);</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span style="color:#000000"><span lang="EN-US">typedef</span><span lang="EN-US"> ULONG (*NTUSERGETFOREGROUNDWINDOW)(VOID);</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span style="color:#000000"><span lang="EN-US">typedef</span><span lang="EN-US"> HWND (*NTUSERWINDOWFROMPOINT)(LONG, LONG);</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span style="color:#000000"><span lang="EN-US">NTSTATUS</span><span lang="EN-US"> ZwQuerySystemInformation(
</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; IN ULONG SystemInformationClass,</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; IN PVOID SystemInformation,</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; IN ULONG SystemInformationLength,</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; OUT PULONG ReturnLength);</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span style="color:#000000"><span lang="EN-US">NTSTATUS</span><span lang="EN-US"> ZwDuplicateObject(</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; IN HANDLE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SourceProcessHandle,</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; IN PHANDLE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SourceHandle,</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; IN HANDLE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TargetProcessHandle,</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; OUT PHANDLE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TargetHandle,</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; IN ACCESS_MASK&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DesiredAccessOPTIONAL,</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; IN BOOLEAN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; InheritHandle,</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; IN ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Options);</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span style="color:#000000"><span lang="EN-US">NTSTATUS</span><span lang="EN-US"> ZwQueryObject(</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;IN HANDLE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ObjectHandle,</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; IN ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ObjectInformationClass,</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; OUT PVOID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ObjectInformation,</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; IN ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ObjectInformationLength,</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; OUT PULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ReturnLengthOPTIONAL);</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span style="color:#000000"><span lang="EN-US">NTSTATUS</span><span lang="EN-US"> PsLookupProcessByProcessId(</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IN ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ulProcId,</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OUT PEPROCESS*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pEProcess);</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span style="color:#000000"><span lang="EN-US">NTSTATUS</span><span lang="EN-US"> KeAttachProcess(PEPROCESSpPeb);</span></span></p>
<p><span style="color:#000000"><span lang="EN-US">NTSTATUS</span><span lang="EN-US"> KeDetachProcess();</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span style="color:#000000"><span lang="EN-US">NTSTATUS</span><span lang="EN-US"> MyNtUserFindWindowEx(</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; IN HWND hwndParent,</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; IN HWND hwndChild,</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; IN PUNICODE_STRING pstrClassNameOPTIONAL,
</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; IN PUNICODE_STRING pstrWindowNameOPTIONAL,
</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; IN DWORD dwType);</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span style="color:#000000"><span lang="EN-US">NTSTATUS</span><span lang="EN-US"> MyNtUserBuildHwndList(</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; IN HDESK hdesk,
</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; IN HWND hwndNext,
</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; IN ULONG fEnumChildren,</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; IN DWORD idThread,</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; IN UINT cHwndMax,</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; OUT HWND *phwndFirst,</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; OUT ULONG* pcHwndNeeded);</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span style="color:#000000"><span lang="EN-US">UINT_PTR</span><span lang="EN-US"> MyNtUserQueryWindow(</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;IN ULONG WindowHandle,</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;IN ULONG TypeInformation);</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span style="color:#000000"><span lang="EN-US">ULONG</span><span lang="EN-US"> MyNtUserGetForegroundWindow(VOID);</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span style="color:#000000"><span lang="EN-US">HWND</span><span lang="EN-US"> MyNtUserWindowFromPoint(LONGx, LONG y);</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span style="color:#000000"><span lang="EN-US">__declspec</span><span lang="EN-US">(dllimport) _stdcall KeAddSystemServiceTable(PVOID,PVOID, PVOID,PVOID, PVOID);</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span style="color:#000000"><span lang="EN-US">////////////////////</span>定義所用到的全域變數///////////////</span></p>
<p><span style="color:#000000"><span lang="EN-US">__declspec</span><span lang="EN-US">(dllimport)&nbsp; ServiceDescriptorTableEntry KeServiceDescriptorTable;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span style="color:#000000"><span lang="EN-US">unsigned</span><span lang="EN-US"> long OldCr0;</span></span></p>
<p><span style="color:#000000"><span lang="EN-US">UNICODE_STRING</span><span lang="EN-US"> DeviceNameString;</span></span></p>
<p><span style="color:#000000"><span lang="EN-US">UNICODE_STRING</span><span lang="EN-US"> LinkDeviceNameString;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span style="color:#000000"><span lang="EN-US">NTUSERFINDWINDOWEX</span><span lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; g_OriginalNtUserFindWindowEx;</span></span></p>
<p><span style="color:#000000"><span lang="EN-US">NTUSERBUILDHWNDLIST</span><span lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; g_OriginalNtUserBuildHwndList;</span></span></p>
<p><span style="color:#000000"><span lang="EN-US">NTUSERQUERYWINDOW</span><span lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; g_OriginalNtUserQueryWindow;</span></span></p>
<p><span style="color:#000000"><span lang="EN-US">NTUSERGETFOREGROUNDWINDOW</span><span lang="EN-US">&nbsp;&nbsp; g_OriginalNtUserGetForegroundWindow;</span></span></p>
<p><span style="color:#000000"><span lang="EN-US">NTUSERWINDOWFROMPOINT</span><span lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; g_OriginalNtUserWindowFromPoint;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span style="color:#000000"><span lang="EN-US">PEPROCESS</span><span lang="EN-US"> crsEProc;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span style="color:#000000"><span lang="EN-US">CCHAR</span><span lang="EN-US">&nbsp;&nbsp;&nbsp;&nbsp; outBuf[1024];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //</span>輸入緩衝區大小</span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span style="color:#000000"><span lang="EN-US">HANDLE</span><span lang="EN-US"> ProcessIdToProtect = (HANDLE)0;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //</span>保護的控制碼</span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span style="color:#000000"><span lang="EN-US">ULONG</span><span lang="EN-US"> NtUserFindWindowEx_callnumber = 0;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //NtUserFindWindowEx</span>的服號</span></p>
<p><span style="color:#000000"><span lang="EN-US">ULONG</span><span lang="EN-US"> NtUserGetForegroundWindow_callnumber = 0;</span></span></p>
<p><span style="color:#000000"><span lang="EN-US">ULONG</span><span lang="EN-US"> NtUserQueryWindow_callnumber = 0;</span></span></p>
<p><span style="color:#000000"><span lang="EN-US">ULONG</span><span lang="EN-US"> NtUserBuildHwndList_callnumber = 0;</span></span></p>
<p><span style="color:#000000"><span lang="EN-US">ULONG</span><span lang="EN-US"> NtUserWindowFromPoint_callnumber = 0;</span></span></p>
<p><span style="color:#000000"><span lang="EN-US">ULONG</span><span lang="EN-US"> LastForegroundWindow;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span style="color:#000000"><span lang="EN-US">unsigned</span><span lang="EN-US"> int getAddressOfShadowTable()</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">{</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; unsigned int i;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; unsigned char *p;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; unsigned int dwordatbyte;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; p = (unsigned char*) KeAddSystemServiceTable;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; for(i = 0; i &lt; 4096; i++,p++)</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; {</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; __try</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dwordatbyte = *(unsignedint*)p;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; __except(EXCEPTION_EXECUTE_HANDLER)</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return 0;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(MmIsAddressValid((PVOID)dwordatbyte))</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(memcmp((PVOID)dwordatbyte,&amp;KeServiceDescriptorTable, 16) == 0)</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if((PVOID)dwordatbyte == &amp;KeServiceDescriptorTable)</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; continue;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return dwordatbyte;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; }</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; return 0;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">}</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span style="color:#000000"><span lang="EN-US">ULONG</span><span lang="EN-US"> getShadowTable()</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">{</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; KeServiceDescriptorTableShadow = (PServiceDescriptorTableEntry) getAddressOfShadowTable();</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; if(KeServiceDescriptorTableShadow== NULL)</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; {</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DbgPrint("hooker.sys:Couldnt find shadowtable!");</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return FALSE;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; }</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; else</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; {</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DbgPrint("hooker.sys:Shadowtable has been found!");</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DbgPrint("hooker.sys:Shadowtable entries: %d", KeServiceDescriptorTableShadow[1].NumberOfServices);</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return TRUE;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; }</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">} </span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span style="color:#000000"><span lang="EN-US">//</span>根據作業系統來確定具體函數的服務號</span></p>
<p><span style="color:#000000"><span lang="EN-US">VOID</span><span lang="EN-US"> InitCallNumber()</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">{</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; ULONG majorVersion,minorVersion;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; PsGetVersion( &amp;majorVersion,&amp;minorVersion, NULL,NULL );</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; if ( majorVersion== 5 &amp;&amp; minorVersion == 2 )</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; {</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DbgPrint("comint32:Running on Windows 2003");</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NtUserFindWindowEx_callnumber = 0x179;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NtUserGetForegroundWindow_callnumber = 0x193;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NtUserBuildHwndList_callnumber = 0x137;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NtUserQueryWindow_callnumber = 0x1E1;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NtUserWindowFromPoint_callnumber = 0x24C;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; }</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; else if ( majorVersion == 5 &amp;&amp; minorVersion == 1 )</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; {</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DbgPrint("comint32:Running on Windows XP");</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NtUserFindWindowEx_callnumber = 0x17A;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NtUserGetForegroundWindow_callnumber = 0x194;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NtUserBuildHwndList_callnumber = 0x138;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NtUserQueryWindow_callnumber = 0x1E3;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NtUserWindowFromPoint_callnumber = 0x250;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; }</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; else if ( majorVersion == 5 &amp;&amp; minorVersion == 0 )</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; {</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DbgPrint("comint32:Running on Windows 2000");</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NtUserFindWindowEx_callnumber = 0x170;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NtUserGetForegroundWindow_callnumber = 0x189;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NtUserBuildHwndList_callnumber = 0x12E;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NtUserQueryWindow_callnumber = 0x1D2;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NtUserWindowFromPoint_callnumber = 0x238;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; }</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">}</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span style="color:#000000"><span lang="EN-US">PVOID</span><span lang="EN-US"> GetInfoTable(ULONGATableType)</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">{</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; ULONG mSize =0x4000;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; PVOID mPtr = NULL;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; NTSTATUS St;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; do</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; {</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mPtr = ExAllocatePool(PagedPool, mSize);</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; memset(mPtr, 0,mSize);</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (mPtr)</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; St = ZwQuerySystemInformation(ATableType, mPtr,mSize, NULL);</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else return NULL;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (St == STATUS_INFO_LENGTH_MISMATCH)</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ExFreePool(mPtr);</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mSize = mSize *2;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; } while (St == STATUS_INFO_LENGTH_MISMATCH);</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; if (St == STATUS_SUCCESS) returnmPtr;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; ExFreePool(mPtr);</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; return NULL;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">}</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span style="color:#000000"><span lang="EN-US">HANDLE</span><span lang="EN-US"> GetCsrPid()</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">{</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; HANDLE Process,hObject;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; HANDLE CsrId =(HANDLE)0;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; OBJECT_ATTRIBUTES obj;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; CLIENT_ID cid;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; UCHAR Buff[0x100];</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; POBJECT_NAME_INFORMATION ObjName= (PVOID)&amp;Buff;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; PSYSTEM_HANDLE_INFORMATION_EX Handles;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; ULONG r;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; Handles = GetInfoTable(SystemHandleInformation);</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; if (!Handles) return CsrId;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; for (r = 0; r &lt; Handles-&gt;NumberOfHandles; r++)</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; {</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (Handles-&gt;Information[r].ObjectTypeNumber == 21) //Portobject</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; InitializeObjectAttributes(&amp;obj, NULL, OBJ_KERNEL_HANDLE, NULL,NULL);</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cid.UniqueProcess= (HANDLE)Handles-&gt;Information[r].ProcessId;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cid.UniqueThread= 0;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (NT_SUCCESS(NtOpenProcess(&amp;Process,PROCESS_DUP_HANDLE, &amp;obj, &amp;cid)))</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (NT_SUCCESS(ZwDuplicateObject(Process,(HANDLE)Handles-&gt;Information[r].Handle,NtCurrentProcess(),&amp;hObject, 0, 0, DUPLICATE_SAME_ACCESS)))</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (NT_SUCCESS(ZwQueryObject(hObject, ObjectNameInformation,ObjName, 0x100, NULL)))</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (ObjName-&gt;Name.Buffer&amp;&amp; !wcsncmp(L"\\Windows\\ApiPort", ObjName-&gt;Name.Buffer, 20))</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CsrId = (HANDLE)Handles-&gt;Information[r].ProcessId;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } </span>
</span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ZwClose(hObject);</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ZwClose(Process);</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; }</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; ExFreePool(Handles);</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; return CsrId;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">}</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span style="color:#000000"><span lang="EN-US">BOOLEAN</span><span lang="EN-US"> Sleep(ULONG MillionSecond)</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">{</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; NTSTATUS st;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; LARGE_INTEGER DelayTime;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; DelayTime = RtlConvertLongToLargeInteger(-10000*MillionSecond);</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; st=KeDelayExecutionThread(KernelMode, FALSE,&amp;DelayTime );</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; return (NT_SUCCESS(st));</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">}</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span style="color:#000000"><span lang="EN-US">NTSTATUS</span><span lang="EN-US"> DriverEntry (INPDRIVER_OBJECT DriverObject,IN PUNICODE_STRINGRegistryPath)</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">{</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; NTSTATUS status;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; PDEVICE_OBJECT&nbsp;&nbsp;deviceObject;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; RtlInitUnicodeString( &amp;DeviceNameString,&nbsp;&nbsp;&nbsp; HIDE_PROCESS_WIN32_DEV_NAME );</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; RtlInitUnicodeString( &amp;LinkDeviceNameString,HIDE_PROCESS_DEV_NAME);</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; KdPrint(("DriverEntryEnter............................\n"));</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; status = IoCreateDevice(</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DriverObject,</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &amp;DeviceNameString,</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FILE_DEVICE_DISK_FILE_SYSTEM,</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FILE_DEVICE_SECURE_OPEN,</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FALSE,</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &amp; deviceObject );</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; if (!NT_SUCCESS( status )) </span>
</span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; {</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; KdPrint(( "DriverEntry:Error creating control device object, status=%08x\n", status ));</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return status;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; }</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; status = IoCreateSymbolicLink(</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (PUNICODE_STRING) &amp;LinkDeviceNameString,</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (PUNICODE_STRING) &amp;DeviceNameString</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; );</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; if (!NT_SUCCESS(status))</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; {</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IoDeleteDevice(deviceObject);</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return status;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; }</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span style="color:#000000"><span lang="EN-US">&nbsp;&nbsp;&nbsp; //</span>獲得shadow的地址</span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; getShadowTable();</span></span></p>
<p><span style="color:#000000"><span lang="EN-US">&nbsp;&nbsp;&nbsp; //</span>根據不同的系統獲得不同的函數服務號</span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; InitCallNumber();</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; DriverObject-&gt;MajorFunction[IRP_MJ_CREATE] = HideProcess_Create;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; DriverObject-&gt;MajorFunction[IRP_MJ_CLOSE] = HideProcess_Close;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; DriverObject-&gt;MajorFunction[IRP_MJ_DEVICE_CONTROL] = HideProcess_IoControl;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; DriverObject-&gt;DriverUnload=UnloadDriver;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; status = PsLookupProcessByProcessId((ULONG)GetCsrPid(),&amp;crsEProc);</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; if (!NT_SUCCESS( status ))</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; {</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DbgPrint("PsLookupProcessByProcessId()error\n");</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return status;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; }</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; KeAttachProcess(crsEProc);</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; __try</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; {</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ((KeServiceDescriptorTableShadow!=NULL) \</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &amp;&amp; (NtUserFindWindowEx_callnumber!=0) &amp;&amp; (NtUserGetForegroundWindow_callnumber!=0) \</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &amp;&amp; (NtUserBuildHwndList_callnumber!=0) &amp;&amp; (NtUserQueryWindow_callnumber!=0) \</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &amp;&amp; (NtUserWindowFromPoint_callnumber!=0))
</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; g_OriginalNtUserFindWindowEx&nbsp;&nbsp;&nbsp;&nbsp; = (NTUSERFINDWINDOWEX)KeServiceDescriptorTableShadow[1].ServiceTableBase[NtUserFindWindowEx_callnumber];</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; g_OriginalNtUserQueryWindow=(NTUSERQUERYWINDOW)KeServiceDescriptorTableShadow[1].ServiceTableBase[NtUserQueryWindow_callnumber];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; g_OriginalNtUserBuildHwndList=(NTUSERBUILDHWNDLIST)KeServiceDescriptorTableShadow[1].ServiceTableBase[NtUserBuildHwndList_callnumber];</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; g_OriginalNtUserGetForegroundWindow=(NTUSERGETFOREGROUNDWINDOW)KeServiceDescriptorTableShadow[1].ServiceTableBase[NtUserGetForegroundWindow_callnumber];</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; g_OriginalNtUserWindowFromPoint = (NTUSERWINDOWFROMPOINT)KeServiceDescriptorTableShadow[1].ServiceTableBase[NtUserWindowFromPoint_callnumber];&nbsp;
</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; KeServiceDescriptorTableShadow=NULL;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _asm</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CLI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //dissableinterrupt</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MOV&nbsp;&nbsp;&nbsp; EAX, CR0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //move CR0register into EAX</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AND EAX, NOT 10000H //disable WPbit
</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MOV&nbsp;&nbsp; &nbsp;CR0, EAX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //write register back</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ((KeServiceDescriptorTableShadow!=NULL) &amp;&amp; (NtUserFindWindowEx_callnumber!=0)&amp;&amp; (NtUserGetForegroundWindow_callnumber!=0)&amp;&amp; (NtUserBuildHwndList_callnumber!=0)&amp;&amp; (NtUserQueryWindow_callnumber!=0))</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (NTUSERFINDWINDOWEX)(KeServiceDescriptorTableShadow[1].ServiceTableBase[NtUserFindWindowEx_callnumber])= MyNtUserFindWindowEx;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (NTUSERQUERYWINDOW)KeServiceDescriptorTableShadow[1].ServiceTableBase[NtUserQueryWindow_callnumber]&nbsp; = MyNtUserQueryWindow;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (NTUSERBUILDHWNDLIST)KeServiceDescriptorTableShadow[1].ServiceTableBase[NtUserBuildHwndList_callnumber]= MyNtUserBuildHwndList;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (NTUSERGETFOREGROUNDWINDOW)KeServiceDescriptorTableShadow[1].ServiceTableBase[NtUserGetForegroundWindow_callnumber]= MyNtUserGetForegroundWindow;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (NTUSERWINDOWFROMPOINT)KeServiceDescriptorTableShadow[1].ServiceTableBase[NtUserWindowFromPoint_callnumber]= MyNtUserWindowFromPoint;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _asm </span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MOV&nbsp;&nbsp;&nbsp; EAX, CR0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //move CR0register into EAX</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OR&nbsp;&nbsp;&nbsp;&nbsp; EAX, 10000H&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//enable WP bit&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MOV&nbsp;&nbsp;&nbsp; CR0, EAX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //writeregister back&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; STI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //enableinterrupt</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; }</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; __finally</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; {</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; KeDetachProcess(); </span>
</span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; }</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; return status ;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">}</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span style="color:#000000"><span lang="EN-US">NTSTATUS</span><span lang="EN-US"> HideProcess_Create(INPDEVICE_OBJECT DeviceObject,IN PIRP Irp)</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">{</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; DbgPrint("HideProcess_Create\n");</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; Irp-&gt;IoStatus.Status = STATUS_SUCCESS;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; Irp-&gt;IoStatus.Information = 0;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; IoCompleteRequest(Irp,IO_NO_INCREMENT);</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; return Irp-&gt;IoStatus.Status;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">}</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span style="color:#000000"><span lang="EN-US">NTSTATUS</span><span lang="EN-US"> HideProcess_Close(INPDEVICE_OBJECT DeviceObject,IN PIRP Irp)</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">{</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; DbgPrint("HideProcess_Close\n");</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; Irp-&gt;IoStatus.Status = STATUS_SUCCESS;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; Irp-&gt;IoStatus.Information = 0;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; IoCompleteRequest(Irp,IO_NO_INCREMENT);</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; return Irp-&gt;IoStatus.Status;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">}</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span style="color:#000000"><span lang="EN-US">NTSTATUS</span><span lang="EN-US"> HideProcess_IoControl(INPDEVICE_OBJECT DeviceObject,IN PIRP Irp)</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">{</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; NTSTATUS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; status= STATUS_SUCCESS;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;controlCode;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; PIO_STACK_LOCATION&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; irpStack;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; HANDLE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hEvent;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; OBJECT_HANDLE_INFORMATION&nbsp; objHandleInfo;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; outputLength,inputLength;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; PVOID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; inputBuffer;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; DWORD dd;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; irpStack = IoGetCurrentIrpStackLocation(Irp);</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; outputLength = irpStack-&gt;Parameters.DeviceIoControl.OutputBufferLength;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; inputLength=irpStack-&gt;Parameters.DeviceIoControl.InputBufferLength;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; controlCode = irpStack-&gt;Parameters.DeviceIoControl.IoControlCode;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; DbgPrint("INCONTROL\r\n");</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; switch(controlCode)</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; {</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; case IO_PROTECT:</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ProcessIdToProtect = (HANDLE)irpStack-&gt;Parameters.DeviceIoControl.Type3InputBuffer;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DbgPrint("IO_PROTECT:%d",ProcessIdToProtect);</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; default:</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; }</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; Irp-&gt;IoStatus.Status = STATUS_SUCCESS;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; Irp-&gt;IoStatus.Information = 0;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; IoCompleteRequest(Irp,IO_NO_INCREMENT);</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; return status;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">}</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span style="color:#000000"><span lang="EN-US">VOID</span><span lang="EN-US"> UnloadDriver(INPDRIVER_OBJECT DriverObject)</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">{</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; UNICODE_STRING uniWin32NameString;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; UNICODE_STRING LinkNameString;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; PDEVICE_OBJECT deviceObject;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; NTSTATUS status;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; status = PsLookupProcessByProcessId((ULONG)GetCsrPid(),&amp;crsEProc);</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; if (!NT_SUCCESS( status ))</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; {</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DbgPrint("PsLookupProcessByProcessId()error\n");</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return ;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; }</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; KeAttachProcess(crsEProc);</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; //////////////////////UnHookZwQuerySystemInformation/////////////////////////////////////////////////</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; __try</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; {</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _asm</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CLI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //dissableinterrupt</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MOV&nbsp;&nbsp;&nbsp; EAX, CR0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //move CR0register into EAX</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AND EAX, NOT 10000H&nbsp;&nbsp;&nbsp;//disable WP bit
</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MOV&nbsp;&nbsp;&nbsp; CR0, EAX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //writeregister back</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ((KeServiceDescriptorTableShadow!=NULL) &amp;&amp; (NtUserFindWindowEx_callnumber!=0)&amp;&amp; (NtUserGetForegroundWindow_callnumber!=0)&amp;&amp; (NtUserBuildHwndList_callnumber!=0)&amp;&amp; (NtUserQueryWindow_callnumber!=0))</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (NTUSERFINDWINDOWEX)(KeServiceDescriptorTableShadow[1].ServiceTableBase[NtUserFindWindowEx_callnumber])= g_OriginalNtUserFindWindowEx;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (NTUSERQUERYWINDOW)KeServiceDescriptorTableShadow[1].ServiceTableBase[NtUserQueryWindow_callnumber]&nbsp;&nbsp;&nbsp; = g_OriginalNtUserQueryWindow;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (NTUSERBUILDHWNDLIST)KeServiceDescriptorTableShadow[1].ServiceTableBase[NtUserBuildHwndList_callnumber]&nbsp; = g_OriginalNtUserBuildHwndList;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (NTUSERGETFOREGROUNDWINDOW)KeServiceDescriptorTableShadow[1].ServiceTableBase[NtUserGetForegroundWindow_callnumber]&nbsp;&nbsp;&nbsp; = g_OriginalNtUserGetForegroundWindow;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (NTUSERWINDOWFROMPOINT)KeServiceDescriptorTableShadow[1].ServiceTableBase[NtUserWindowFromPoint_callnumber]= g_OriginalNtUserWindowFromPoint;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _asm </span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MOV&nbsp;&nbsp;&nbsp; EAX, CR0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //move CR0register into EAX</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OR&nbsp;&nbsp;&nbsp;&nbsp; EAX, 10000H&nbsp;&nbsp;&nbsp;&nbsp;//enable WP bit&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MOV&nbsp;&nbsp;&nbsp; CR0, EAX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //writeregister back&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; STI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //enableinterrupt</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; }</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; __finally</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; {</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; KeDetachProcess();</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Sleep(50);</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; }</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; deviceObject= DriverObject-&gt;DeviceObject;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; IoDeleteSymbolicLink(&amp;LinkDeviceNameString);</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; ASSERT(!deviceObject-&gt;AttachedDevice);</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; if ( deviceObject!= NULL )</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; {</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IoDeleteDevice( deviceObject);</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; }</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">}</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span style="color:#000000"><span lang="EN-US">NTSTATUS</span><span lang="EN-US"> MyNtUserFindWindowEx(</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; IN HWND hwndParent,</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; IN HWND hwndChild,</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; IN PUNICODE_STRING pstrClassNameOPTIONAL,
</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; IN PUNICODE_STRING pstrWindowNameOPTIONAL,
</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; IN DWORD dwType)</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">{</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; ULONG result;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; result = g_OriginalNtUserFindWindowEx(hwndParent, hwndChild,pstrClassName, pstrWindowName,dwType);</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; if (PsGetCurrentProcessId()!=ProcessIdToProtect)</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; {</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ULONG ProcessID;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ProcessID = g_OriginalNtUserQueryWindow(result, 0);</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DbgPrint("ProcessID:%d",ProcessID);</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (ProcessID==(ULONG)ProcessIdToProtect)</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return 0;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; }</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; return result;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">}</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span style="color:#000000"><span lang="EN-US">NTSTATUS</span><span lang="EN-US"> MyNtUserBuildHwndList(INHDESK hdesk,IN HWND hwndNext, IN ULONG fEnumChildren,IN DWORD idThread, IN UINT cHwndMax, OUT HWND *phwndFirst, OUTULONG* pcHwndNeeded)</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">{</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; NTSTATUS result;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; if (PsGetCurrentProcessId()!=ProcessIdToProtect)</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; {</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ULONG ProcessID;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (fEnumChildren==1)</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ProcessID = g_OriginalNtUserQueryWindow((ULONG)hwndNext,0);</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (ProcessID==(ULONG)ProcessIdToProtect)</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return STATUS_UNSUCCESSFUL;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; result = g_OriginalNtUserBuildHwndList(hdesk,hwndNext,fEnumChildren,idThread,cHwndMax,phwndFirst,pcHwndNeeded);</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (result==STATUS_SUCCESS)</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ULONG i=0;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ULONG j;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while (i&lt;*pcHwndNeeded)</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ProcessID=g_OriginalNtUserQueryWindow((ULONG)phwndFirst[i],0);</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (ProcessID==(ULONG)ProcessIdToProtect)</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (j=i; j&lt;(*pcHwndNeeded)-1; j++)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; phwndFirst[j]=phwndFirst[j+1];
</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; phwndFirst[*pcHwndNeeded-1]=0;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (*pcHwndNeeded)--;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; continue; </span>
</span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; i++;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>
</span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return result;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; }</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; return g_OriginalNtUserBuildHwndList(hdesk,hwndNext,fEnumChildren,idThread,cHwndMax,phwndFirst,pcHwndNeeded);</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">}</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span style="color:#000000"><span lang="EN-US">ULONG</span><span lang="EN-US"> MyNtUserGetForegroundWindow(VOID)</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">{</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; ULONG result;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; result= g_OriginalNtUserGetForegroundWindow();&nbsp;
</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; if (PsGetCurrentProcessId()!=ProcessIdToProtect)</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; {</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ULONG ProcessID;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ProcessID=g_OriginalNtUserQueryWindow(result, 0);</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (ProcessID == (ULONG)ProcessIdToProtect)</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; result=LastForegroundWindow;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LastForegroundWindow=result;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; }&nbsp; </span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; return result;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">}</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span style="color:#000000"><span lang="EN-US">UINT_PTR</span><span lang="EN-US"> MyNtUserQueryWindow(INULONG WindowHandle,IN ULONG TypeInformation)</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">{</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; ULONG WindowHandleProcessID;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; if (PsGetCurrentProcessId()!=ProcessIdToProtect)</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; {</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WindowHandleProcessID = g_OriginalNtUserQueryWindow(WindowHandle,0);</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (WindowHandleProcessID==(ULONG)ProcessIdToProtect)</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return 0;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; }</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; return g_OriginalNtUserQueryWindow(WindowHandle,TypeInformation);</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">}</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;</span></span></p>
<p><span style="color:#000000"><span lang="EN-US">HWND</span><span lang="EN-US"> MyNtUserWindowFromPoint(LONGx, LONG y)</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">{</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">&nbsp;&nbsp;&nbsp; return 0;</span></span></p>
<p><span lang="EN-US"><span style="color:#000000">}</span></span></p>
</div>
<p class="author">殘月影 发表在 <a href="http://www.pixnet.net/">痞客邦 PIXNET</a> <a href="http://kost0911.pixnet.net/blog/post/60179407#comments">
留言</a>(0) <a href="http://kost0911.pixnet.net/blog/post/60179407#trackback">引用</a>(0)
<span class="author-views">人气(<span id="BlogArticleCount-60179407">90</span>)</span>
</p>
<div class="forward"><a>E-mail转寄</a> <a>转寄至留言板</a></div>
<br>
</div>




<!-- Baidu Button BEGIN -->

<div class="bdsharebuttonbox bdshare-button-style0-16" style="float: right;" data-bd-bind="1429966844974">
<a href="http://blog.csdn.net/lionzl/article/details/7735483#" class="bds_more" data-cmd="more" style="background-position:0 0 !important; background-image: url(http://bdimg.share.baidu.com/static/api/img/share/icons_0_16.png?v=d754dcc0.png) !important"></a>
<a href="http://blog.csdn.net/lionzl/article/details/7735483#" class="bds_qzone" data-cmd="qzone" title="分享到QQ空间" style="background-position:0 -52px !important"></a>
<a href="http://blog.csdn.net/lionzl/article/details/7735483#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博" style="background-position:0 -104px !important"></a>
<a href="http://blog.csdn.net/lionzl/article/details/7735483#" class="bds_tqq" data-cmd="tqq" title="分享到腾讯微博" style="background-position:0 -260px !important"></a>
<a href="http://blog.csdn.net/lionzl/article/details/7735483#" class="bds_renren" data-cmd="renren" title="分享到人人网" style="background-position:0 -208px !important"></a>
<a href="http://blog.csdn.net/lionzl/article/details/7735483#" class="bds_weixin" data-cmd="weixin" title="分享到微信" style="background-position:0 -1612px !important"></a>
</div>
<script>window._bd_share_config = { "common": { "bdSnsKey": {}, "bdText": "", "bdMini": "1", "bdMiniList": false, "bdPic": "", "bdStyle": "0", "bdSize": "16" }, "share": {} }; with (document) 0[(getElementsByTagName('head')[0] || body).appendChild(createElement('script')).src = 'http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion=' + ~(-new Date() / 36e5)];</script>
<!-- Baidu Button END -->

<!--192.168.100.35-->
<ul class="article_next_prev">
            <li class="prev_article"><span onclick="_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_shangyipian&#39;]);location.href=&#39;/lionzl/article/details/7727897&#39;;">上一篇</span><a href="http://blog.csdn.net/lionzl/article/details/7727897" onclick="_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_shangyipian&#39;])">使用SandCastle创建.Net帮助文档</a></li>
            <li class="next_article"><span onclick="_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_xiayipian&#39;]);location.href=&#39;/lionzl/article/details/7735535&#39;;">下一篇</span><a href="http://blog.csdn.net/lionzl/article/details/7735535" onclick="_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_xiayipian&#39;])">shadow ssdt</a></li>
</ul>

<!-- Baidu Button BEGIN -->
<script type="text/javascript" id="bdshare_js" data="type=tools&amp;uid=1536434" src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/bds_s_v2.js"></script>

<script type="text/javascript">
    document.getElementById("bdshell_js").src = "http://bdimg.share.baidu.com/static/js/shell_v2.js?cdnversion=" + Math.ceil(new Date()/3600000)
</script>
<!-- Baidu Button END -->


</div>
      <dl class="blog-associat-tag">
        <dt>主题推荐</dt>
        <dd>
                <a href="http://www.csdn.net/tag/windows%20xp" target="_blank" class="blog-tage-red">windows xp</a> 
                <a href="http://www.csdn.net/tag/exception" target="_blank" class="blog-tage-red">exception</a> 
                <a href="http://www.csdn.net/tag/boolean" target="_blank" class="blog-tage-red">boolean</a> 
                <a href="http://www.csdn.net/tag/access" target="_blank" class="blog-tage-red">access</a> 
                <a href="http://www.csdn.net/tag/kernel" target="_blank" class="blog-tage-red">kernel</a> 
        </dd>
    </dl> 

<style>
.blog-ass-articl dd {
color: #369;
width: 99%; /*修改行*/
float: left;
overflow: hidden;
font: normal normal 12px/23px "SimSun";
height: 23px;
margin: 0;
padding: 0 0 0 10px;
margin-right: 30px;
background: url(../images/blog-dot-red3.gif) no-repeat 0 10px;
}

</style>

<dl class="blog-ass-articl tracking-ad" data-mod="popu_36" id="res-relatived" style="height:  160px;"> 
     <dt><span>猜你在找</span></dt>    

     <div id="res" style="width: 42%;float: left;margin-right: 30px;"><dd style="background:url(http://static.blog.csdn.net/skin/default/images/blog-dot-red3.gif) no-repeat 0 10px;"><a href="http://blog.csdn.net/xfreeboy/article/details/159550" title="Phrack最新公布的内核态RootKit的技术细节e文" strategy="SearchAlgorithm">Phrack最新公布的内核态RootKit的技术细节e文</a></dd><dd style="background:url(http://static.blog.csdn.net/skin/default/images/blog-dot-red3.gif) no-repeat 0 10px;"><a href="http://blog.csdn.net/LionD8/article/details/335094" title="Phrack最新公布的内核态RootKit的技术细节转" strategy="SearchAlgorithm">Phrack最新公布的内核态RootKit的技术细节转</a></dd><dd style="background:url(http://static.blog.csdn.net/skin/default/images/blog-dot-red3.gif) no-repeat 0 10px;"><a href="http://blog.csdn.net/evi10r/article/details/6932607" title="简单实现了下SSDT SHADOW HOOK" strategy="SearchAlgorithm">简单实现了下SSDT SHADOW HOOK</a></dd><dd style="background:url(http://static.blog.csdn.net/skin/default/images/blog-dot-red3.gif) no-repeat 0 10px;"><a href="http://blog.csdn.net/cosmoslife/article/details/13005983" title="简单实现了下SSDT SHADOW HOOK" strategy="SearchAlgorithm">简单实现了下SSDT SHADOW HOOK</a></dd><dd style="background:url(http://static.blog.csdn.net/skin/default/images/blog-dot-red3.gif) no-repeat 0 10px;"><a href="http://blog.csdn.net/cosmoslife/article/details/7864815" title="SSDT Shadow Hook" strategy="SearchAlgorithm">SSDT Shadow Hook</a></dd><dd style="background:url(http://static.blog.csdn.net/skin/default/images/blog-dot-red3.gif) no-repeat 0 10px;"><a href="http://blog.csdn.net/ccx_john/article/details/12831497" title="简单实现了下SSDT SHADOW HOOK" strategy="SearchAlgorithm">简单实现了下SSDT SHADOW HOOK</a></dd><dd style="background:url(http://static.blog.csdn.net/skin/default/images/blog-dot-red3.gif) no-repeat 0 10px;"><a href="http://blog.csdn.net/zqf_office/article/details/12967355" title="简单实现了下SSDT SHADOW HOOK" strategy="SearchAlgorithm">简单实现了下SSDT SHADOW HOOK</a></dd><dd style="background:url(http://static.blog.csdn.net/skin/default/images/blog-dot-red3.gif) no-repeat 0 10px;"><a href="http://blog.csdn.net/rosykee/article/details/39934453" title="WINDOWS内核学习笔记1Shadow SSDT表" strategy="SearchAlgorithm">WINDOWS内核学习笔记1Shadow SSDT表</a></dd><dd style="background:url(http://static.blog.csdn.net/skin/default/images/blog-dot-red3.gif) no-repeat 0 10px;"><a href="http://blog.csdn.net/whf727/article/details/4843854" title="Windows 7 RC - Shadow SSDT 服务名表" strategy="SearchAlgorithm">Windows 7 RC - Shadow SSDT 服务名表</a></dd><dd style="background:url(http://static.blog.csdn.net/skin/default/images/blog-dot-red3.gif) no-repeat 0 10px;"><a href="http://blog.csdn.net/gimbow/article/details/5882549" title="Windows内核新手上路2挂钩shadow SSDT" strategy="SearchAlgorithm">Windows内核新手上路2挂钩shadow SSDT</a></dd></div>

    <div id="adCollege" style="width: 42%;float: left;">
            <dd style="background:url(http://static.blog.csdn.net/skin/default/images/blog-dot-red3.gif) no-repeat 0 10px;">
                <a href="http://edu.csdn.net/course/detail/662" title="【精品课程】Java Swing、JDBC开发桌面级应用" strategy="SearchAlgorithm" target="_blank">【精品课程】Java Swing、JDBC开发桌面级应用</a></dd>
            <dd style="background:url(http://static.blog.csdn.net/skin/default/images/blog-dot-red3.gif) no-repeat 0 10px;">
                <a href="http://edu.csdn.net/course/detail/661" title="【精品课程】ASP.NET下工作流技术WorkFlow4.0应用开发" strategy="SearchAlgorithm" target="_blank">【精品课程】ASP.NET下工作流技术WorkFlow4.0应用开发</a></dd>
            <dd style="background:url(http://static.blog.csdn.net/skin/default/images/blog-dot-red3.gif) no-repeat 0 10px;">
                <a href="http://edu.csdn.net/course/detail/648" title="【精品课程】深度解析iOS8开发技术（Swift版）第3季：屏幕适配" strategy="SearchAlgorithm" target="_blank">【精品课程】深度解析iOS8开发技术（Swift版）第3季：屏幕适配</a></dd>
            <dd style="background:url(http://static.blog.csdn.net/skin/default/images/blog-dot-red3.gif) no-repeat 0 10px;">
                <a href="http://edu.csdn.net/course/detail/645" title="【精品课程】R语言与数据分析【基础篇】" strategy="SearchAlgorithm" target="_blank">【精品课程】R语言与数据分析【基础篇】</a></dd>
            <dd style="background:url(http://static.blog.csdn.net/skin/default/images/blog-dot-red3.gif) no-repeat 0 10px;">
                <a href="http://edu.csdn.net/course/detail/587" title="【精品课程】J2SE轻松入门第三季" strategy="SearchAlgorithm" target="_blank">【精品课程】J2SE轻松入门第三季</a></dd>
    </div>
   
</dl>


<div id="job_blog_reco"><dl class="blog-ass-articl tracking-ad" data-mod="popu_72"><dt><span>准备好了么？&nbsp;<label class="po_blg_detail_tiao">跳</label><label class="po_blg_detail_ba">吧</label><label class="po_blg_detail_th">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;！</label></span><a href="http://job.csdn.net/" target="_blank" class="po_blg_more">更多职位尽在&nbsp;<label class="po_blg_detail_csdn">CSDN JOB</label></a></dt><dd class="po_blg_dd"><div class="po_blg_po"><a href="http://job.csdn.net/Job/Index?jobID=85461" title="IOS工程师" strategy="LatestRecommend" target="_blank">IOS工程师</a></div><div class="po_blg_company"><a href="http://pr.csdn.net/enterprise/ent_home?orgid=436017" title="店集配供应链管理有限公司" target="_blank">店集配供应链管理有限公司</a></div><label class="po_blg_separator">|</label><div class="po_blg_salary"><a href="http://job.csdn.net/Job/Index?jobID=85461" target="_blank">10-15K/月</a></div><a class="po_blg_iwant" href="http://job.csdn.net/Job/Index?jobID=85461" target="_blank">我要跳槽</a></dd><dd class="po_blg_dd"><div class="po_blg_po"><a href="http://job.csdn.net/Job/Index?jobID=85462" title="Android工程师" strategy="LatestRecommend" target="_blank">Android工程师</a></div><div class="po_blg_company"><a href="http://pr.csdn.net/enterprise/ent_home?orgid=436017" title="店集配供应链管理有限公司" target="_blank">店集配供应链管理有限公司</a></div><label class="po_blg_separator">|</label><div class="po_blg_salary"><a href="http://job.csdn.net/Job/Index?jobID=85462" target="_blank">8-16K/月</a></div><a class="po_blg_iwant" href="http://job.csdn.net/Job/Index?jobID=85462" target="_blank">我要跳槽</a></dd><dd class="po_blg_dd"><div class="po_blg_po"><a href="http://job.csdn.net/Job/Index?jobID=82579" title="PHP技术合伙人" strategy="LatestRecommend" target="_blank">PHP技术合伙人</a></div><div class="po_blg_company"><a href="http://pr.csdn.net/enterprise/ent_home?orgid=435311" title="杭州趴体科技有限公司" target="_blank">杭州趴体科技有限公司</a></div><label class="po_blg_separator">|</label><div class="po_blg_salary"><a href="http://job.csdn.net/Job/Index?jobID=82579" target="_blank">8-11K/月</a></div><a class="po_blg_iwant" href="http://job.csdn.net/Job/Index?jobID=82579" target="_blank">我要跳槽</a></dd><dd class="po_blg_dd"><div class="po_blg_po"><a href="http://job.csdn.net/Job/Index?jobID=85988" title="Java 开发工程师" strategy="LatestRecommend" target="_blank">Java 开发工程师</a></div><div class="po_blg_company"><a href="http://pr.csdn.net/enterprise/ent_home?orgid=436157" title="陕西德度信息科技有限公司" target="_blank">陕西德度信息科技有限公司</a></div><label class="po_blg_separator">|</label><div class="po_blg_salary"><a href="http://job.csdn.net/Job/Index?jobID=85988" target="_blank">4-6K/月</a></div><a class="po_blg_iwant" href="http://job.csdn.net/Job/Index?jobID=85988" target="_blank">我要跳槽</a></dd></dl></div>

<script type="text/javascript">
    var searchtitletags = 'Hook Shadow SSDT' + ',' + 'windows xp,exception,boolean,access,kernel';
    searchService({
        index: 'blog',
        query: searchtitletags,
        from: 5,
        size: 5,
        appendTo: '#res',
        url: 'recommend',
        his: 2,
        client: "blog_cf_enhance",
        tmpl: '<dd style="background:url(http://static.blog.csdn.net/skin/default/images/blog-dot-red3.gif) no-repeat 0 10px;"><a href="#{ url }" title="#{ title }" strategy="#{ strategy }">#{ title }</a></dd>'
    });

 </script>   



    <div id="ad_cen">
   
          <script type="text/javascript">
              new Ad(4, 'ad_cen');
          </script>
    </div>
<div class="comment_class">
    <div id="comment_title" class="panel_head">
        <span class="see_comment">查看评论</span><a name="comments"></a></div>
    <div id="comment_list"><br>&nbsp;&nbsp;暂无评论<br><br><div class="clear"></div></div>
    <div id="comment_bar">
    </div>
    <div id="comment_form"><div class="guest_link">您还没有登录,请<a href="javascript:void(0);" onclick="javascript:loginbox();">[登录]</a>或<a href="http://passport.csdn.net/account/register?from=http%3A%2F%2Fblog.csdn.net%2Flionzl%2Farticle%2Fdetails%2F7735483">[注册]</a></div></div>

    <div class="announce">
        * 以上用户言论只代表其个人观点，不代表CSDN网站的观点或立场<a name="reply"></a><a name="quote"></a></div>
</div>

<script type="text/javascript">
    var fileName = '7735483';
    var commentscount = 0;
    var islock = false
</script>
<script type="text/javascript" src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/comment.js"></script>
    <div id="ad_bot">
    </div>
    <script type="text/javascript">
    new Ad(5, 'ad_bot');
    </script>
<div id="report_dialog">
</div>

<div id="d-top" style="bottom:60px;">
        <a id="quick-reply" class="btn btn-top q-reply" title="快速回复" style="display:none;">
            <img src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/blog-icon-reply.png" alt="快速回复">
        </a>    

    <a id="d-top-a" class="btn btn-top backtop" style="display: none;" title="返回顶部" onclick="_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_huidaodingbu&#39;])">         
         <img src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/top.png" alt="TOP">
    </a>
</div>
<script type="text/javascript">
    $(function ()
    {
        $("#ad_frm_0").height("90px");
        
        setTimeout(function(){
            $("#ad_frm_2").height("200px");
        },1000);
        
        /*
        if($("#comment_content").length>0)
        {
            $("#quick-reply").show();

            $("#quick-reply").click(function(){
                setEditorFocus();
            });
        }       
     
        var d_top = $('#d-top-a');

        document.onscroll = function ()
        {
            var scrTop = (document.body.scrollTop || document.documentElement.scrollTop);
            if (scrTop > 500)
            {
                d_top.show();
            } else
            {
                d_top.hide();
            }
        }
        $('#d-top-a').click(function ()
        {
            scrollTo(0, 0);
            this.blur();
            return false;
        });
        */
    });
  
</script>
<style type="text/css">
    .tag_list
    {
        background: none repeat scroll 0 0 #FFFFFF;
        border: 1px solid #D7CBC1;
        color: #000000;
        font-size: 12px;
        line-height: 20px;
        list-style: none outside none;
        margin: 10px 2% 0 1%;
        padding: 1px;
    }
    .tag_list h5
    {
        background: none repeat scroll 0 0 #E0DBD3;
        color: #47381C;
        font-size: 12px;
        height: 24px;
        line-height: 24px;
        padding: 0 5px;
        margin: 0;
    }
    .tag_list h5 a
    {
        color: #47381C;
    }
    .classify
    {
        margin: 10px 0;
        padding: 4px 12px 8px;
    }
    .classify a
    {
        margin-right: 20px;
        white-space: nowrap;
    }
</style>
<div class="tag_list">
    <h5>
        <a href="http://www.csdn.net/tag/" target="_blank">核心技术类目</a></h5>
    <div class="classify">
<a title="全部主题" href="http://www.csdn.net/tag" target="_blank" onclick="LogClickCount(this,336);">全部主题</a>
<a title="Hadoop" href="http://g.csdn.net/5272865" target="_blank" onclick="LogClickCount(this,336);">Hadoop</a>
<a title="AWS" href="http://g.csdn.net/5272866" target="_blank" onclick="LogClickCount(this,336);">AWS</a>
<a title="移动游戏" href="http://g.csdn.net/5272870" target="_blank" onclick="LogClickCount(this,336);">移动游戏</a>
<a title="Java" href="http://g.csdn.net/5272871" target="_blank" onclick="LogClickCount(this,336);">Java</a>
<a title="Android" href="http://g.csdn.net/5272872" target="_blank" onclick="LogClickCount(this,336);">Android</a>
<a title="iOS" href="http://g.csdn.net/5272873" target="_blank" onclick="LogClickCount(this,336);">iOS</a>
<a title="Swift" href="http://g.csdn.net/5272868" target="_blank" onclick="LogClickCount(this,336);">Swift</a>
<a title="智能硬件" href="http://g.csdn.net/5272869" target="_blank" onclick="LogClickCount(this,336);">智能硬件</a>
<a title="Docker" href="http://g.csdn.net/5272867" target="_blank" onclick="LogClickCount(this,336);">Docker</a>
<a title="OpenStack" href="http://g.csdn.net/5272925" target="_blank" onclick="LogClickCount(this,336);">OpenStack</a>
<a title="VPN" href="http://www.csdn.net/tag/vpn" target="_blank" onclick="LogClickCount(this,336);">VPN</a>
<a title="Spark" href="http://g.csdn.net/5272924" target="_blank" onclick="LogClickCount(this,336);">Spark</a>
<a title="ERP" href="http://www.csdn.net/tag/erp" target="_blank" onclick="LogClickCount(this,336);">ERP</a>
<a title="IE10" href="http://www.csdn.net/tag/ie10" target="_blank" onclick="LogClickCount(this,336);">IE10</a>
<a title="Eclipse" href="http://www.csdn.net/tag/eclipse" target="_blank" onclick="LogClickCount(this,336);">Eclipse</a>
<a title="CRM" href="http://www.csdn.net/tag/crm" target="_blank" onclick="LogClickCount(this,336);">CRM</a>
<a title="JavaScript" href="http://www.csdn.net/tag/javascript" target="_blank" onclick="LogClickCount(this,336);">JavaScript</a>
<a title="数据库" href="http://www.csdn.net/tag/%E6%95%B0%E6%8D%AE%E5%BA%93" target="_blank" onclick="LogClickCount(this,336);">数据库</a>
<a title="Ubuntu" href="http://www.csdn.net/tag/ubuntu" target="_blank" onclick="LogClickCount(this,336);">Ubuntu</a>
<a title="NFC" href="http://www.csdn.net/tag/nfc" target="_blank" onclick="LogClickCount(this,336);">NFC</a>
<a title="WAP" href="http://www.csdn.net/tag/wap" target="_blank" onclick="LogClickCount(this,336);">WAP</a>
<a title="jQuery" href="http://www.csdn.net/tag/jquery" target="_blank" onclick="LogClickCount(this,336);">jQuery</a>
<a title="BI" href="http://www.csdn.net/tag/bi" target="_blank" onclick="LogClickCount(this,336);">BI</a>
<a title="HTML5" href="http://www.csdn.net/tag/html5" target="_blank" onclick="LogClickCount(this,336);">HTML5</a>
<a title="Spring" href="http://www.csdn.net/tag/spring" target="_blank" onclick="LogClickCount(this,336);">Spring</a>
<a title="Apache" href="http://www.csdn.net/tag/apache" target="_blank" onclick="LogClickCount(this,336);">Apache</a>
<a title=".NET" href="http://www.csdn.net/tag/.net" target="_blank" onclick="LogClickCount(this,336);">.NET</a>
<a title="API" href="http://www.csdn.net/tag/api" target="_blank" onclick="LogClickCount(this,336);">API</a>
<a title="HTML" href="http://www.csdn.net/tag/html" target="_blank" onclick="LogClickCount(this,336);">HTML</a>
<a title="SDK" href="http://www.csdn.net/tag/sdk" target="_blank" onclick="LogClickCount(this,336);">SDK</a>
<a title="IIS" href="http://www.csdn.net/tag/iis" target="_blank" onclick="LogClickCount(this,336);">IIS</a>
<a title="Fedora" href="http://www.csdn.net/tag/fedora" target="_blank" onclick="LogClickCount(this,336);">Fedora</a>
<a title="XML" href="http://www.csdn.net/tag/xml" target="_blank" onclick="LogClickCount(this,336);">XML</a>
<a title="LBS" href="http://www.csdn.net/tag/lbs" target="_blank" onclick="LogClickCount(this,336);">LBS</a>
<a title="Unity" href="http://www.csdn.net/tag/unity" target="_blank" onclick="LogClickCount(this,336);">Unity</a>
<a title="Splashtop" href="http://www.csdn.net/tag/splashtop" target="_blank" onclick="LogClickCount(this,336);">Splashtop</a>
<a title="UML" href="http://www.csdn.net/tag/uml" target="_blank" onclick="LogClickCount(this,336);">UML</a>
<a title="components" href="http://www.csdn.net/tag/components" target="_blank" onclick="LogClickCount(this,336);">components</a>
<a title="Windows Mobile" href="http://www.csdn.net/tag/windowsmobile" target="_blank" onclick="LogClickCount(this,336);">Windows Mobile</a>
<a title="Rails" href="http://www.csdn.net/tag/rails" target="_blank" onclick="LogClickCount(this,336);">Rails</a>
<a title="QEMU" href="http://www.csdn.net/tag/qemu" target="_blank" onclick="LogClickCount(this,336);">QEMU</a>
<a title="KDE" href="http://www.csdn.net/tag/kde" target="_blank" onclick="LogClickCount(this,336);">KDE</a>
<a title="Cassandra" href="http://www.csdn.net/tag/cassandra" target="_blank" onclick="LogClickCount(this,336);">Cassandra</a>
<a title="CloudStack" href="http://www.csdn.net/tag/cloudstack" target="_blank" onclick="LogClickCount(this,336);">CloudStack</a>
<a title="FTC" href="http://www.csdn.net/tag/ftc" target="_blank" onclick="LogClickCount(this,336);">FTC</a>
<a title="coremail" href="http://www.csdn.net/tag/coremail" target="_blank" onclick="LogClickCount(this,336);">coremail</a>
<a title="OPhone " href="http://www.csdn.net/tag/ophone" target="_blank" onclick="LogClickCount(this,336);">OPhone </a>
<a title="CouchBase" href="http://www.csdn.net/tag/couchbase" target="_blank" onclick="LogClickCount(this,336);">CouchBase</a>
<a title="云计算" href="http://www.csdn.net/tag/%E4%BA%91%E8%AE%A1%E7%AE%97" target="_blank" onclick="LogClickCount(this,336);">云计算</a>
<a title="iOS6" href="http://www.csdn.net/tag/iOS6" target="_blank" onclick="LogClickCount(this,336);">iOS6</a>
<a title="Rackspace " href="http://www.csdn.net/tag/rackspace" target="_blank" onclick="LogClickCount(this,336);">Rackspace </a>
<a title="Web App" href="http://www.csdn.net/tag/webapp" target="_blank" onclick="LogClickCount(this,336);">Web App</a>
<a title="SpringSide" href="http://www.csdn.net/tag/springside" target="_blank" onclick="LogClickCount(this,336);">SpringSide</a>
<a title="Maemo" href="http://www.csdn.net/tag/maemo" target="_blank" onclick="LogClickCount(this,336);">Maemo</a>
<a title="Compuware" href="http://www.csdn.net/tag/compuware" target="_blank" onclick="LogClickCount(this,336);">Compuware</a>
<a title="大数据" href="http://www.csdn.net/tag/%E5%A4%A7%E6%95%B0%E6%8D%AE" target="_blank" onclick="LogClickCount(this,336);">大数据</a>
<a title="aptech" href="http://www.csdn.net/tag/aptech" target="_blank" onclick="LogClickCount(this,336);">aptech</a>
<a title="Perl" href="http://www.csdn.net/tag/perl" target="_blank" onclick="LogClickCount(this,336);">Perl</a>
<a title="Tornado" href="http://www.csdn.net/tag/tornado" target="_blank" onclick="LogClickCount(this,336);">Tornado</a>
<a title="Ruby" href="http://www.csdn.net/tag/ruby" target="_blank" onclick="LogClickCount(this,336);">Ruby</a>
<a title="Hibernate" href="http://www.csdn.net/hibernate" target="_blank" onclick="LogClickCount(this,336);">Hibernate</a>
<a title="ThinkPHP" href="http://www.csdn.net/tag/thinkphp" target="_blank" onclick="LogClickCount(this,336);">ThinkPHP</a>
<a title="HBase" href="http://www.csdn.net/tag/hbase" target="_blank" onclick="LogClickCount(this,336);">HBase</a>
<a title="Pure" href="http://www.csdn.net/tag/pure" target="_blank" onclick="LogClickCount(this,336);">Pure</a>
<a title="Solr" href="http://www.csdn.net/tag/solr" target="_blank" onclick="LogClickCount(this,336);">Solr</a>
<a title="Angular" href="http://www.csdn.net/tag/angular" target="_blank" onclick="LogClickCount(this,336);">Angular</a>
<a title="Cloud Foundry" href="http://www.csdn.net/tag/cloudfoundry" target="_blank" onclick="LogClickCount(this,336);">Cloud Foundry</a>
<a title="Redis" href="http://www.csdn.net/tag/redis" target="_blank" onclick="LogClickCount(this,336);">Redis</a>
<a title="Scala" href="http://www.csdn.net/tag/scala" target="_blank" onclick="LogClickCount(this,336);">Scala</a>
<a title="Django" href="http://www.csdn.net/tag/django" target="_blank" onclick="LogClickCount(this,336);">Django</a>
<a title="Bootstrap" href="http://www.csdn.net/tag/bootstrap" target="_blank" onclick="LogClickCount(this,336);">Bootstrap</a>
    </div>
</div>

<div id="pop_win" style="display:none ;position: absolute; z-index: 10000; border: 1px solid rgb(220, 220, 220); top: 222.5px; left: 630px; opacity: 1; background: none 0px 0px repeat scroll rgb(255, 255, 255);">
    
</div>
<div id="popup_mask"></div>
<style>
    #popup_mask
    {
        position: absolute;
        width: 100%;
        height: 100%;
        background: #000;
        z-index: 9999;
        left: 0px;
        top: 0px;
        opacity: 0.3;
        filter: alpha(opacity=30);
        display: none;
    }

</style>




<script type="text/javascript">
    $(function(){
        setTimeout(function(){
            $(".comment_body:contains('回复')").each(function(index,item){
                var u=$(this).text().split('：')[0].toString().replace("回复","")
                var thisComment=$(this);
                if(u)
                {
                    $.getJSON("https://passport.csdn.net/get/nick?callback=?", {users: u}, function(a) {
                        if(a!=null&&a.data!=null&&a.data.length>0)
                        {
                            nick=a.data[0].n; 
                            if(u!=nick)
                            {
                                thisComment.text(thisComment.text().replace(u,nick));  
                            }
                        }       
                    });  
                }
            });
        },200);  
        
        setTimeout(function(){
            $("a img[src='http://js.tongji.linezing.com/stats.gif']").parent().css({"position":"absolute","left":"50%"});
        },300);
    });

    function loginbox(){
        var $logpop=$("#pop_win");
        $logpop.html('<iframe src="https://passport.csdn.net/account/loginbox?service=http://static.blog.csdn.net/callback.htm" frameborder="0" height="600" width="400" scrolling="no"></iframe>');

        $('#popup_mask').css({
            opacity: 0.5,
            width: $( document ).width() + 'px',
            height:  $( document ).height() + 'px'
        });
        $('#popup_mask').css("display","block");
 
        $logpop.css( {
            top: ($( window ).height() - $logpop.height())/ 2  + $( window 
       ).scrollTop() + 'px',
            left:($( window ).width() - $logpop.width())/ 2
        } );
 
        setTimeout( function () {
            $logpop.show();
            $logpop.css( {
                opacity: 1
            } );
        }, 200 );
 
        $('#popup_mask').unbind("click");
        $('#popup_mask').bind("click", function(){
            $('#popup_mask').hide();
            var $clopop = $("#pop_win");
            $("#common_ask_div_sc").css("display","none");
            $clopop.css( {
                opacity: 0
            } );
            setTimeout( function () {
                $clopop.hide();
            }, 350 );
            return false;
        });
    }    

</script>
                        <div class="clear">
                        </div>
                    </div>                   
                
            </div>
            <div id="side">
    <div class="side">
<div id="panel_Profile" class="panel">
<ul class="panel_head"><span>个人资料</span></ul>
<ul class="panel_body profile">
<div id="blog_userface">
    <a href="http://my.csdn.net/lionzl" target="_blank">
    <img src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/1_lionzl.jpg" title="访问我的空间" style="max-width:90%">
    </a>
    <br>
    <span><a href="http://my.csdn.net/lionzl" class="user_name" target="_blank">lionzl</a></span>
</div>
<div class="interact">
<a href="javascript:void(0);" class="attent" id="span_add_follow" title="[加关注]" onclick="_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_guanzhu&#39;])"></a>

 <a href="javascript:void(0);" class="letter" title="[发私信]" onclick="window.open(&#39;http://msg.csdn.net/letters/model?receiver=lionzl&#39;,&#39;_blank&#39;,&#39;height=350,width=700&#39;);_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_sixin&#39;])"></a>  
</div>
<div id="blog_medal">
                <div id="bms_box">
               </div>
</div>
<ul id="blog_rank">
    <li>访问：<span>855263次</span></li>
    <li>积分：<span>12701</span> </li>    
    <li>等级： <span style="position:relative;display:inline-block;z-index:1">
            <img src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/blog7.png" alt="" style="vertical-align: middle;" id="leveImg">
            <div id="smallTittle" style=" position: absolute;  left: -24px;  top: 25px;  text-align: center;  width: 101px;  height: 32px;  background-color: #fff;  line-height: 32px;  border: 2px #DDDDDD solid;  box-shadow: 0px 2px 2px rgba (0,0,0,0.1);  display: none;   z-index: 999;">
            <div style="left: 42%;  top: -8px;  position: absolute;  width: 0;  height: 0;  border-left: 10px solid transparent;  border-right: 10px solid transparent;  border-bottom: 8px solid #EAEAEA;"></div>
            积分：12701 </div>
        </span>  </li>
    <li>排名：<span>第379名</span></li>
</ul>
<ul id="blog_statistics">
    <li>原创：<span>163篇</span></li>
    <li>转载：<span>1727篇</span></li>
    <li>译文：<span>12篇</span></li>
    <li>评论：<span>112条</span></li>
</ul>
</ul>
</div>




      
<div class="panel" id="panel_Search">
    <ul class="panel_head"><span>文章搜索</span></ul>
    <ul class="panel_body">
        <form id="frmSearch" action="http://so.csdn.net/search" class="form_search" target="_blank">
        <span><input id="inputSearch" type="text" class="blogsearch" title="请输入关键字"></span>
        <input id="btnSubmit" type="button" value="搜索" title="search in blog">
        <input type="hidden" name="q" id="inputQ">
        <input type="hidden" name="t" value="blog">
        <a id="btnSearchBlog" target="_blank"></a>
        </form>
    </ul>
</div>

<script type="text/javascript">
    $(function () {
        $("#btnSubmit").click(function () {           
            search();
        });

        $("#frmSearch").submit(function () {
            search();
            return false;
        });

        function search()
        {
            var url = "http://so.csdn.net/so/search/s.do?q=" + encodeURIComponent($("#inputSearch").val()) + "&u=" + username + "&t=blog";
            window.location.href = url;
        }   
    });
</script>
<div id="panel_Category" class="panel">
<ul class="panel_head"><span>文章分类</span></ul>
<ul class="panel_body">
             <li>
                <a href="http://blog.csdn.net/lionzl/article/category/1430073" onclick="_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_wenzhangfenlei&#39;]); ">专利</a><span>(5)</span>
            </li>
             <li>
                <a href="http://blog.csdn.net/lionzl/article/category/541496" onclick="_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_wenzhangfenlei&#39;]); ">.Net相关</a><span>(121)</span>
            </li>
             <li>
                <a href="http://blog.csdn.net/lionzl/article/category/652655" onclick="_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_wenzhangfenlei&#39;]); ">3D</a><span>(4)</span>
            </li>
             <li>
                <a href="http://blog.csdn.net/lionzl/article/category/737091" onclick="_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_wenzhangfenlei&#39;]); ">c#</a><span>(24)</span>
            </li>
             <li>
                <a href="http://blog.csdn.net/lionzl/article/category/833335" onclick="_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_wenzhangfenlei&#39;]); ">Firefox</a><span>(8)</span>
            </li>
             <li>
                <a href="http://blog.csdn.net/lionzl/article/category/631492" onclick="_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_wenzhangfenlei&#39;]); ">Linux Fedora</a><span>(75)</span>
            </li>
             <li>
                <a href="http://blog.csdn.net/lionzl/article/category/547161" onclick="_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_wenzhangfenlei&#39;]); ">map server</a><span>(3)</span>
            </li>
             <li>
                <a href="http://blog.csdn.net/lionzl/article/category/618456" onclick="_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_wenzhangfenlei&#39;]); ">Oracle</a><span>(14)</span>
            </li>
             <li>
                <a href="http://blog.csdn.net/lionzl/article/category/775210" onclick="_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_wenzhangfenlei&#39;]); ">pacs&amp;amp;lis</a><span>(11)</span>
            </li>
             <li>
                <a href="http://blog.csdn.net/lionzl/article/category/791706" onclick="_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_wenzhangfenlei&#39;]); ">PowerDesigner</a><span>(12)</span>
            </li>
             <li>
                <a href="http://blog.csdn.net/lionzl/article/category/698546" onclick="_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_wenzhangfenlei&#39;]); ">silverLight</a><span>(41)</span>
            </li>
             <li>
                <a href="http://blog.csdn.net/lionzl/article/category/541492" onclick="_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_wenzhangfenlei&#39;]); ">ssdt及驱动</a><span>(68)</span>
            </li>
             <li>
                <a href="http://blog.csdn.net/lionzl/article/category/547160" onclick="_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_wenzhangfenlei&#39;]); ">XSS</a><span>(7)</span>
            </li>
             <li>
                <a href="http://blog.csdn.net/lionzl/article/category/583439" onclick="_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_wenzhangfenlei&#39;]); ">加壳</a><span>(5)</span>
            </li>
             <li>
                <a href="http://blog.csdn.net/lionzl/article/category/541489" onclick="_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_wenzhangfenlei&#39;]); ">数据库</a><span>(121)</span>
            </li>
             <li>
                <a href="http://blog.csdn.net/lionzl/article/category/589007" onclick="_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_wenzhangfenlei&#39;]); ">数据恢复</a><span>(6)</span>
            </li>
             <li>
                <a href="http://blog.csdn.net/lionzl/article/category/674865" onclick="_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_wenzhangfenlei&#39;]); ">测试</a><span>(10)</span>
            </li>
             <li>
                <a href="http://blog.csdn.net/lionzl/article/category/660318" onclick="_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_wenzhangfenlei&#39;]); ">生活</a><span>(40)</span>
            </li>
             <li>
                <a href="http://blog.csdn.net/lionzl/article/category/541493" onclick="_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_wenzhangfenlei&#39;]); ">编程杂烩</a><span>(246)</span>
            </li>
             <li>
                <a href="http://blog.csdn.net/lionzl/article/category/643675" onclick="_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_wenzhangfenlei&#39;]); ">网站管理</a><span>(22)</span>
            </li>
             <li>
                <a href="http://blog.csdn.net/lionzl/article/category/547681" onclick="_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_wenzhangfenlei&#39;]); ">网络编程</a><span>(157)</span>
            </li>
             <li>
                <a href="http://blog.csdn.net/lionzl/article/category/720391" onclick="_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_wenzhangfenlei&#39;]); ">计算机安全</a><span>(205)</span>
            </li>
             <li>
                <a href="http://blog.csdn.net/lionzl/article/category/541491" onclick="_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_wenzhangfenlei&#39;]); ">项目管理</a><span>(280)</span>
            </li>
             <li>
                <a href="http://blog.csdn.net/lionzl/article/category/843724" onclick="_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_wenzhangfenlei&#39;]); ">LAMP</a><span>(86)</span>
            </li>
             <li>
                <a href="http://blog.csdn.net/lionzl/article/category/856359" onclick="_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_wenzhangfenlei&#39;]); ">RFID</a><span>(3)</span>
            </li>
             <li>
                <a href="http://blog.csdn.net/lionzl/article/category/862342" onclick="_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_wenzhangfenlei&#39;]); ">标签技术</a><span>(12)</span>
            </li>
             <li>
                <a href="http://blog.csdn.net/lionzl/article/category/908976" onclick="_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_wenzhangfenlei&#39;]); ">python</a><span>(82)</span>
            </li>
             <li>
                <a href="http://blog.csdn.net/lionzl/article/category/911214" onclick="_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_wenzhangfenlei&#39;]); ">ubuntu</a><span>(124)</span>
            </li>
             <li>
                <a href="http://blog.csdn.net/lionzl/article/category/1067475" onclick="_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_wenzhangfenlei&#39;]); ">VOIP_RTC</a><span>(9)</span>
            </li>
             <li>
                <a href="http://blog.csdn.net/lionzl/article/category/1069646" onclick="_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_wenzhangfenlei&#39;]); ">图像处理(OpenCV)</a><span>(9)</span>
            </li>
             <li>
                <a href="http://blog.csdn.net/lionzl/article/category/1082635" onclick="_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_wenzhangfenlei&#39;]); ">UTM NGFW</a><span>(67)</span>
            </li>
             <li>
                <a href="http://blog.csdn.net/lionzl/article/category/1095914" onclick="_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_wenzhangfenlei&#39;]); ">Android</a><span>(6)</span>
            </li>
             <li>
                <a href="http://blog.csdn.net/lionzl/article/category/1102139" onclick="_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_wenzhangfenlei&#39;]); ">DLP</a><span>(192)</span>
            </li>
             <li>
                <a href="http://blog.csdn.net/lionzl/article/category/1246041" onclick="_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_wenzhangfenlei&#39;]); ">java</a><span>(133)</span>
            </li>
             <li>
                <a href="http://blog.csdn.net/lionzl/article/category/1634437" onclick="_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_wenzhangfenlei&#39;]); ">Algorithm</a><span>(12)</span>
            </li>
             <li>
                <a href="http://blog.csdn.net/lionzl/article/category/1292588" onclick="_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_wenzhangfenlei&#39;]); ">SVM</a><span>(15)</span>
            </li>
             <li>
                <a href="http://blog.csdn.net/lionzl/article/category/1361181" onclick="_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_wenzhangfenlei&#39;]); ">APR</a><span>(11)</span>
            </li>
             <li>
                <a href="http://blog.csdn.net/lionzl/article/category/1358044" onclick="_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_wenzhangfenlei&#39;]); ">MySQL</a><span>(15)</span>
            </li>
             <li>
                <a href="http://blog.csdn.net/lionzl/article/category/1379756" onclick="_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_wenzhangfenlei&#39;]); ">xml</a><span>(10)</span>
            </li>
             <li>
                <a href="http://blog.csdn.net/lionzl/article/category/1390410" onclick="_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_wenzhangfenlei&#39;]); ">boost</a><span>(8)</span>
            </li>
             <li>
                <a href="http://blog.csdn.net/lionzl/article/category/1674147" onclick="_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_wenzhangfenlei&#39;]); ">squid</a><span>(3)</span>
            </li>
             <li>
                <a href="http://blog.csdn.net/lionzl/article/category/1674295" onclick="_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_wenzhangfenlei&#39;]); ">netlink</a><span>(1)</span>
            </li>
             <li>
                <a href="http://blog.csdn.net/lionzl/article/category/1787235" onclick="_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_wenzhangfenlei&#39;]); ">大数据和数据挖掘</a><span>(17)</span>
            </li>
             <li>
                <a href="http://blog.csdn.net/lionzl/article/category/2542159" onclick="_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_wenzhangfenlei&#39;]); ">hadoop</a><span>(6)</span>
            </li>
             <li>
                <a href="http://blog.csdn.net/lionzl/article/category/2614001" onclick="_gaq.push([&#39;_trackEvent&#39;,&#39;function&#39;, &#39;onclick&#39;, &#39;blog_articles_wenzhangfenlei&#39;]); ">NoSQL</a><span>(2)</span>
            </li>
</ul>
</div><div id="panel_Archive" class="panel">
<ul class="panel_head"><span>文章存档</span></ul>
<ul class="panel_body">
<div id="archive_list"><li><a href="http://blog.csdn.net/lionzl/article/month/2015/04">2015年04月</a><span>(16)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2015/03">2015年03月</a><span>(23)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2015/02">2015年02月</a><span>(2)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2015/01">2015年01月</a><span>(26)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2014/12">2014年12月</a><span>(16)</span></li><span class="hidelist" style="display:none;"><li><a href="http://blog.csdn.net/lionzl/article/month/2014/11">2014年11月</a><span>(17)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2014/10">2014年10月</a><span>(21)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2014/09">2014年09月</a><span>(41)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2014/08">2014年08月</a><span>(17)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2014/07">2014年07月</a><span>(50)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2014/05">2014年05月</a><span>(20)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2014/04">2014年04月</a><span>(13)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2014/03">2014年03月</a><span>(20)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2014/02">2014年02月</a><span>(22)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2014/01">2014年01月</a><span>(16)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2013/12">2013年12月</a><span>(25)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2013/11">2013年11月</a><span>(11)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2013/10">2013年10月</a><span>(11)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2013/09">2013年09月</a><span>(25)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2013/08">2013年08月</a><span>(27)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2013/07">2013年07月</a><span>(38)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2013/06">2013年06月</a><span>(33)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2013/05">2013年05月</a><span>(23)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2013/04">2013年04月</a><span>(76)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2013/03">2013年03月</a><span>(58)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2013/02">2013年02月</a><span>(10)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2013/01">2013年01月</a><span>(51)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2012/12">2012年12月</a><span>(50)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2012/11">2012年11月</a><span>(18)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2012/10">2012年10月</a><span>(71)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2012/09">2012年09月</a><span>(25)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2012/08">2012年08月</a><span>(15)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2012/07">2012年07月</a><span>(38)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2012/06">2012年06月</a><span>(31)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2012/05">2012年05月</a><span>(20)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2012/04">2012年04月</a><span>(22)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2012/03">2012年03月</a><span>(33)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2012/02">2012年02月</a><span>(42)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2012/01">2012年01月</a><span>(13)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2011/12">2011年12月</a><span>(19)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2011/11">2011年11月</a><span>(67)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2011/10">2011年10月</a><span>(38)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2011/09">2011年09月</a><span>(30)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2011/08">2011年08月</a><span>(44)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2011/07">2011年07月</a><span>(59)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2011/06">2011年06月</a><span>(34)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2011/05">2011年05月</a><span>(17)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2011/04">2011年04月</a><span>(6)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2011/03">2011年03月</a><span>(27)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2011/02">2011年02月</a><span>(8)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2011/01">2011年01月</a><span>(28)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2010/12">2010年12月</a><span>(14)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2010/11">2010年11月</a><span>(25)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2010/10">2010年10月</a><span>(22)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2010/09">2010年09月</a><span>(14)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2010/08">2010年08月</a><span>(42)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2010/07">2010年07月</a><span>(18)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2010/06">2010年06月</a><span>(22)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2010/05">2010年05月</a><span>(7)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2010/04">2010年04月</a><span>(7)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2010/03">2010年03月</a><span>(9)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2010/02">2010年02月</a><span>(3)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2010/01">2010年01月</a><span>(2)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2009/12">2009年12月</a><span>(12)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2009/11">2009年11月</a><span>(15)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2009/10">2009年10月</a><span>(5)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2009/09">2009年09月</a><span>(5)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2009/08">2009年08月</a><span>(33)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2009/07">2009年07月</a><span>(17)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2009/06">2009年06月</a><span>(25)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2009/05">2009年05月</a><span>(51)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2009/04">2009年04月</a><span>(20)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2009/03">2009年03月</a><span>(70)</span></li><li><a href="http://blog.csdn.net/lionzl/article/month/2008/12">2008年12月</a><span>(1)</span></li></span><div id="archive_list_button" class="list_closed">展开</div></div>
</ul>
</div>
<div id="hotarticls" class="panel">
<ul class="panel_head">
    <span>       
阅读排行    </span>
</ul>

<ul class="panel_body itemlist">
<li>
<a href="http://blog.csdn.net/lionzl/article/details/6881772" title="utf8转gb2312精简版">utf8转gb2312精简版</a><span>(41671)</span>
</li>
<li>
<a href="http://blog.csdn.net/lionzl/article/details/4861996" title="用BT3破解无线网络密码的教程以及如何制作U盘版和光盘版BT3 ">用BT3破解无线网络密码的教程以及如何制作U盘版和光盘版BT3 </a><span>(12905)</span>
</li>
<li>
<a href="http://blog.csdn.net/lionzl/article/details/4007206" title=" close_wait状态和time_wait状态 "> close_wait状态和time_wait状态 </a><span>(12449)</span>
</li>
<li>
<a href="http://blog.csdn.net/lionzl/article/details/7215978" title="stun turn ice等穿越NAT方法">stun turn ice等穿越NAT方法</a><span>(5952)</span>
</li>
<li>
<a href="http://blog.csdn.net/lionzl/article/details/6636791" title="使用Jquery EasyUi常见问题解决方案 刷新 easyui datagrid 数据">使用Jquery EasyUi常见问题解决方案 刷新 easyui datagrid 数据</a><span>(5933)</span>
</li>
<li>
<a href="http://blog.csdn.net/lionzl/article/details/7866748" title="季卫东：中国互联网企业平均寿命只有三到五年">季卫东：中国互联网企业平均寿命只有三到五年</a><span>(5204)</span>
</li>
<li>
<a href="http://blog.csdn.net/lionzl/article/details/8029210" title="2010新编中国顶级黑客圈内人物资料和QQ,微博以及博客详解">2010新编中国顶级黑客圈内人物资料和QQ,微博以及博客详解</a><span>(4836)</span>
</li>
<li>
<a href="http://blog.csdn.net/lionzl/article/details/7658417" title="招聘总经理的真实试题">招聘总经理的真实试题</a><span>(4477)</span>
</li>
<li>
<a href="http://blog.csdn.net/lionzl/article/details/7206997" title="收房注意事项">收房注意事项</a><span>(4269)</span>
</li>
<li>
<a href="http://blog.csdn.net/lionzl/article/details/7935827" title="揭秘：美国云计算近五年的发展">揭秘：美国云计算近五年的发展</a><span>(4116)</span>
</li>
</ul>
</div>
<div id="hotarticls2" class="panel">
<ul class="panel_head"><span>评论排行</span></ul>
<ul class="panel_body itemlist">
<li>
<a href="http://blog.csdn.net/lionzl/article/details/7215978" title="stun turn ice等穿越NAT方法">stun turn ice等穿越NAT方法</a><span>(6)</span>
</li>
<li>
<a href="http://blog.csdn.net/lionzl/article/details/4861996" title="用BT3破解无线网络密码的教程以及如何制作U盘版和光盘版BT3 ">用BT3破解无线网络密码的教程以及如何制作U盘版和光盘版BT3 </a><span>(5)</span>
</li>
<li>
<a href="http://blog.csdn.net/lionzl/article/details/6585909" title="DevPartner BoundsChecker dpinjsvc 服务无法启动">DevPartner BoundsChecker dpinjsvc 服务无法启动</a><span>(4)</span>
</li>
<li>
<a href="http://blog.csdn.net/lionzl/article/details/6257957" title="可伸缩性最佳实践：来自eBay的经验">可伸缩性最佳实践：来自eBay的经验</a><span>(3)</span>
</li>
<li>
<a href="http://blog.csdn.net/lionzl/article/details/7970228" title="ASLR保护启用了吗">ASLR保护启用了吗</a><span>(3)</span>
</li>
<li>
<a href="http://blog.csdn.net/lionzl/article/details/16840867" title="python win8 安装 ez_setup错误解决办法 UnicodeDecodeError: &#39;ascii&#39; codec can&#39;t decode byte">python win8 安装 ez_setup错误解决办法 UnicodeDecodeError: 'ascii' codec can't decode byte</a><span>(3)</span>
</li>
<li>
<a href="http://blog.csdn.net/lionzl/article/details/22889781" title="数据抓取的艺术（一~三）：Selenium+Phantomjs数据抓取环境配置">数据抓取的艺术（一~三）：Selenium+Phantomjs数据抓取环境配置</a><span>(3)</span>
</li>
<li>
<a href="http://blog.csdn.net/lionzl/article/details/4007223" title=" 项目管理实践一 工具 "> 项目管理实践一 工具 </a><span>(2)</span>
</li>
<li>
<a href="http://blog.csdn.net/lionzl/article/details/4012289" title="理解tcp顺序释放操作和tcp的半关闭 ">理解tcp顺序释放操作和tcp的半关闭 </a><span>(2)</span>
</li>
<li>
<a href="http://blog.csdn.net/lionzl/article/details/4363971" title="如何实现自动安装根证书">如何实现自动安装根证书</a><span>(2)</span>
</li>
</ul>
</div>
<div id="homepageArticles" class="panel tracking-ad" data-mod="popu_4">
<ul class="panel_head"><span>推荐文章</span></ul>
<ul class="panel_body" id="ad_commend"></ul>
</div>
<script type="text/javascript">
 new Ad(12, 'ad_commend');
</script><div id="newcomments" class="panel">
<ul class="panel_head"><span>最新评论</span></ul>
<ul class="panel_body itemlist">
    <li>
   
         <a href="http://blog.csdn.net/lionzl/article/details/7238093#comments">动态库dll中生成对话框，若包括ActiveX控件，创建对话框失败时，要在InitInstance()中加上： OleInitialize(NULL) &amp; AfxEnableControlContai</a>
    <p style="margin:0px;"><a href="http://blog.csdn.net/teibin" class="user_name">铁兵</a>:
好人了，解决了我调了3天的bug
    </p>
    </li>
    <li>
   
         <a href="http://blog.csdn.net/lionzl/article/details/44173919#comments">Zend Studio 12 安装及破解</a>
    <p style="margin:0px;"><a href="http://blog.csdn.net/qq_26837615" class="user_name">qq_26837615</a>:
赞一个
    </p>
    </li>
    <li>
   
         <a href="http://blog.csdn.net/lionzl/article/details/44339373#comments">最新：2015年申报高新技术企业须满足的条件</a>
    <p style="margin:0px;"><a href="http://blog.csdn.net/lionzl" class="user_name">lionzl</a>:
http://www.qianshungx.com/
    </p>
    </li>
    <li>
   
         <a href="http://blog.csdn.net/lionzl/article/details/37923587#comments">常用企业管理工具介绍</a>
    <p style="margin:0px;"><a href="http://blog.csdn.net/dabenzhu1984" class="user_name">dabenzhu1984</a>:
麦肯锡7S模型指出了企业在发展过程中必须全面地考虑各方面的情况。值得学习！！！
    </p>
    </li>
    <li>
   
         <a href="http://blog.csdn.net/lionzl/article/details/8627946#comments">我的Linux PC开发环境</a>
    <p style="margin:0px;"><a href="http://blog.csdn.net/u010850027" class="user_name">丁国华</a>:
谢谢分享 学习了
    </p>
    </li>
    <li>
   
         <a href="http://blog.csdn.net/lionzl/article/details/8515434#comments">IT外企那点儿事——转自博客园作者觉先</a>
    <p style="margin:0px;"><a href="http://blog.csdn.net/u010850027" class="user_name">丁国华</a>:
谢谢分享 学习了`(*∩_∩*)′
    </p>
    </li>
    <li>
   
         <a href="http://blog.csdn.net/lionzl/article/details/41680453#comments">ext4分区中恢复被删除的文件</a>
    <p style="margin:0px;"><a href="http://blog.csdn.net/lionzl" class="user_name">lionzl</a>:
http://www.r-tt.com/data_recovery_linux/Download.s...
    </p>
    </li>
    <li>
   
         <a href="http://blog.csdn.net/lionzl/article/details/41680403#comments">Anti cross-site scripting (XSS) filter for Java web apps</a>
    <p style="margin:0px;"><a href="http://blog.csdn.net/lionzl" class="user_name">lionzl</a>:
https://www.owasp.org/index.php/Category:OWASP_Ant...
    </p>
    </li>
    <li>
   
         <a href="http://blog.csdn.net/lionzl/article/details/25814325#comments">[lingpipe学习笔记]基于LingPipe的文本倾向性分析</a>
    <p style="margin:0px;"><a href="http://blog.csdn.net/hwwn2009" class="user_name">古韦</a>:
你好，你有使用中文的words-zh-as.CompiledSpellChecker吗？官网没找到使...
    </p>
    </li>
    <li>
   
         <a href="http://blog.csdn.net/lionzl/article/details/7215978#comments">stun turn ice等穿越NAT方法</a>
    <p style="margin:0px;"><a href="http://blog.csdn.net/fool4" class="user_name">fool4</a>:
mark
    </p>
    </li>
</ul>
</div>


<div id="custom_column_992553" class="panel">
<ul class="panel_head"><span>codeproject</span></ul>
<ul class="panel_body">
<ul><li><a href="http://www.codeproject.com/KB/winsdk/3Steps.aspx" target="_blank">native application</a></li><li><a href="http://www.codeproject.com/KB/threads/NativeThreadInjection.aspx" target="_blank">native application2</a></li><li><a href="http://www.codeproject.com/KB/system/hooksys.aspx" target="_blank">hook API</a></li><li><a href="https://www.hbgary.com/community/richblog/" target="_blank">ru hack analasys</a></li><li><a href="http://www.codeproject.com/KB/files/FDump.aspx" target="_blank">fdump</a></li><li><a href="http://www.codeproject.com/KB/files/NTFSUndelete.aspx" target="_blank">ntfs undelete</a></li><li><a href="http://www.asterisk.org/" target="_blank">Call Center开发</a></li><li><a href="http://curl.haxx.se/" target="_blank">URL lib</a></li><li><a href="http://www.commandline.co.uk/lib/treeview/index.php" target="_blank">Commandling</a></li><li><a href="http://martinfowler.com/eaaCatalog/" target="_blank">patterns of enterprise architecture</a></li><li><a href="http://www.jenkinssoftware.com/" target="_blank">RakNet多人游戏通信引擎</a></li><li><a href="http://kevinfan.blog.51cto.com/1037293/295967" target="_blank">Silver Light 学习资料</a></li><li><a href="http://www.nunit.org/index.php?p=home" target="_blank">NUnit C#第三方库 mono的一部分</a></li><li><a href="http://www.codeproject.com/KB/office/ExcelReader.aspx" target="_blank">纯c#读取excel</a></li><li><a href="http://www.gemboxsoftware.com/GBSpreadsheet.htm" target="_blank">商业的C#读取excel组建，但是用在WCF时出问题。</a></li><li><a href="http://www.tarasco.org/" target="_blank">安全工具</a></li><li><a href="http://damagelab.org/lofiversion/index.php?t=419&st=790" target="_blank">俄罗斯 h‘ack tools 网址</a></li><li><a href="http://rdgsoft.8k.com/Tejon.html" target="_blank">Tejon 1.4 翻墙才能访问</a></li><li><a href="http://sourceforge.net/projects/zerowine/" target="_blank">恶意软件检测环境</a></li><li><a href="http://nutss.gforge.cis.cornell.edu/stunt.php" target="_blank">STUNT NAT 类库</a></li><li><a href="http://www.functionx.com/" target="_blank">C++ CLI资源网站</a></li><li><a href="http://www.maticsoft.com/" target="_blank">动软.Net代码生成器</a></li><li><a href="http://www.swig.org/" target="_blank">c++转c#</a> (<a href="http://www.swig.org/" target="_blank">RSS</a>)</li><li><a href="http://www.cabiatl.com/mricro/" target="_blank">pacs dicom</a> (<a href="http://www.cabiatl.com/mricro/" target="_blank">RSS</a>)</li><li><a href="http://www.clearcanvas.ca/dnn/" target="_blank">http://www.clearcanvas.ca/dnn/</a></li><li><a href="https://github.com/rcd/mdcm" target="_blank">https://github.com/rcd/mdcm</a> (<a href="https://github.com/rcd/mdcm" target="_blank">RSS</a>)</li><li><a href="http://sourceforge.net/apps/mediawiki/gdcm/index.php?title=Main_Page" target="_blank">gdcm</a></li><li><a href="http://www.opensc.ws/forum.php" target="_blank">开源安全论坛</a></li><li><a href="http://www.cplusplus.com/" target="_blank">http://www.cplusplus.com/</a> (<a href="http://www.cplusplus.com/" target="_blank">RSS</a>)</li><li><a href="http://www.password-crackers.com/en/category_121/" target="_blank">俄罗斯密码破解网站</a></li><li><a href="http://entlib.codeplex.com/" target="_blank">企业应用程序开发库</a></li><li><a href="http://www.terrainformatica.com/htmlayout/prices.whtm" target="_blank">HTML LayOut 界面设计</a></li><li><a href="http://www.hur.cn/" target="_blank">华软源码</a></li><li><a href="http://gsoap2.sourceforge.net/" target="_blank">gsoap</a></li><li><a href="http://www.oschina.net/p/nginx" target="_blank">nginx</a> (<a href="http://nginx.org/en/download.html%20nginx" target="_blank">RSS</a>)</li><li><a href="http://hadoop.apache.org/" target="_blank">hadoop</a></li><li><a href="http://zh.wikipedia.org/wiki/MapReduce" target="_blank">MapReduce</a></li><li><a href="http://www.tbdata.org/" target="_blank">淘宝数据平台与产品部官方博客</a></li><li><a href="http://www.w3school.com.cn/js/js_special_characters.asp" target="_blank">JSP学习网址</a></li><li><a href="http://netgroup.polito.it/tools" target="_blank">网络工具</a></li><li><a href="http://ted.mielczarek.org/code/mozilla/" target="_blank">Firefox extension 编程辅助网站</a></li><li><a href="http://www.hacksrus.com/~ginda/ve%3C/ul%3E%3C/div%3E%3Cdiv%20id=" custom_column_992554"="" class="panel">
<ul class="panel_head"><span>Linux</span></ul>
</a><ul class="panel_body"><a href="http://www.hacksrus.com/~ginda/ve%3C/ul%3E%3C/div%3E%3Cdiv%20id=" custom_column_992554"="" class="panel">
</a><ul><a href="http://www.hacksrus.com/~ginda/ve%3C/ul%3E%3C/div%3E%3Cdiv%20id=" custom_column_992554"="" class="panel"></a><li><a href="http://www.hacksrus.com/~ginda/ve%3C/ul%3E%3C/div%3E%3Cdiv%20id=" custom_column_992554"="" class="panel"></a><a href="http://www.freeos.com/guides/lsst/index.html" target="_blank">shell编程</a></li><li><a href="http://www.nessus.org/nessus/" target="_blank">漏洞扫描</a></li><li><a href="http://assarbad.net/" target="_blank">DDK Wizard 安全技术个人网站</a></li><li><a href="http://fregen.yo2.cn/articles/xul-basic.html" target="_blank">Firefox extension 编程个人网站</a></li></ul>
</ul>
</li></ul></ul></div>

<div id="custom_column_992555" class="panel">
<ul class="panel_head"><span>msdn</span></ul>
<ul class="panel_body">
<ul><li><a href="http://msdn.microsoft.com/zh-cn/magazine/rss/default.aspx?year=&month=&col=&author=" target="_blank">msdnRSS</a> (<a href="http://msdn.microsoft.com/zh-cn/magazine/rss/default.aspx?year=&month=&col=&author=" target="_blank">RSS</a>)</li><li><a href="http://www.file-upload.net/" target="_blank">file upload</a></li><li><a href="http://www.codeproject.com/KB/IP/webem.aspx" target="_blank">web control</a></li><li><a href="http://technet.microsoft.com/en-us/sysinternals/bb795534.aspx" target="_blank">http://technet.microsoft.com/en-us/sysinternals/bb795534.aspx</a></li><li><a href="http://undocumented.ntinternals.net/" target="_blank">undocumented.ntinternals</a></li><li><a href="http://www.whitecell.org/" target="_blank">vulnerability</a></li><li><a href="http://www.nvlabs.in/" target="_blank">indea bootkit</a></li><li><a href="http://en.wikipedia.org/wiki/File_Allocation_Table" target="_blank">fat</a></li><li><a href="http://www.ntfs.com/ntfs.htm" target="_blank">ntfs</a></li><li><a href="http://www.reddragonfly.org/ntfs/help/about.html" target="_blank">ntfs</a></li><li><a href="http://sqlcat.com/" target="_blank">http://sqlcat.com/</a></li><li><a href="http://slbindabledatagrid.codeplex.com/" target="_blank">silver light bindableedatagrid</a></li><li><a href="http://msdn.microsoft.com/zh-cn/magazine/cc135911.aspx" target="_blank">msdn silverlight</a></li><li><a href="http://www.learn-silverlight-tutorial.com/AccessingDataUsingSilverlight.cfm" target="_blank">silverLight学习</a></li><li><a href="http://www.connectionstrings.com/" target="_blank">数据库连接字符串</a></li><li><a href="http://msdn.microsoft.com/en-us/library/ms177045.aspx" target="_blank">C++ 支持库</a></li></ul>
</ul>
</div>

<div id="custom_column_992556" class="panel">
<ul class="panel_head"><span>openssl&amp;amp;CA</span></ul>
<ul class="panel_body">
<ul><li><a href="http://www.slproweb.com/products/Win32OpenSSL.html" target="_blank">openssl Windows Installer</a></li><li><a href="http://www.globalssl.cn/certificate/SSL/FreeSSL/" target="_blank">http://www.globalssl.cn/certificate/SSL/FreeSSL/</a></li><li><a href="https://www.freeca.cn/application.aspx" target="_blank">https://www.freeca.cn/application.aspx</a></li><li><a href="http://www.startssl.com/" target="_blank">http://www.startssl.com/</a></li></ul>
</ul>
</div>

<div id="custom_column_992557" class="panel">
<ul class="panel_head"><span>wiki</span></ul>
<ul class="panel_body">
<ul><li><a href="http://www.phrack.com/" target="_blank">http://www.phrack.com/</a></li><li><a href="http://en.wikipedia.org/wiki/File_Allocation_Table" target="_blank">fat</a></li><li><a href="http://www.roundpolygons.com/" target="_blank">SQL工具</a></li><li><a href="http://www.red-gate.com/products/SQL_Prompt/index.htm" target="_blank">SQL工具2</a></li><li><a href="http://www.intel.com/cd/ids/developer/apac/zho/columns/performance/300270.htm?page=2" target="_blank">磁盘IO分析</a> (<a href="http://www.intel.com/cd/ids/developer/apac/zho/columns/performance/300270.htm?page=2" target="_blank">RSS</a>)</li><li><a href="http://www.c-sharpcorner.com/" target="_blank">c#Corner</a></li><li><a href="http://www.codeplex.com/" target="_blank">www.codeplex.com</a></li></ul>
</ul>
</div>    </div>
    <div class="clear">
    </div>
</div>

            <div class="clear">
            </div>
        </div>
        

<script type="text/javascript" src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/cnick.js"></script>
<script type="text/javascript" src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/newblog.min.js"></script>


<script type="text/javascript" src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/showblogmedal.ashx"></script>
<script type="text/javascript" src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/JavaScript1.js"></script><link rel="stylesheet" type="text/css" href="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/pub_footer_2014.css"><div class="pub_fo"><div id="pub_footerall" class="pub_footer_new"><dl><dt></dt> <dd class="foot_sub_menu"><a href="http://www.csdn.net/company/about.html" target="_blank">公司简介</a><span>|</span><a href="http://www.csdn.net/company/recruit.html" target="_blank">招贤纳士</a><span>|</span><a href="http://www.csdn.net/company/marketing.html" target="_blank">广告服务</a><span>|</span><a href="http://www.csdn.net/company/account.html" target="_blank">银行汇款帐号</a><span>|</span><a href="http://www.csdn.net/company/contact.html" target="_blank">联系方式</a><span>|</span><a href="http://www.csdn.net/company/statement.html" target="_blank">版权声明</a><span>|</span><a href="http://www.csdn.net/company/layer.html" target="_blank">法律顾问</a><span>|</span><a href="mailto:webmaster@csdn.net">问题报告</a><span>|</span><a target="_blank" href="http://www.csdn.net/friendlink.html">合作伙伴</a><span>|</span><a href="http://bbs.csdn.net/forums/Service" target="_blank">论坛反馈</a></dd><dd class="foot_contact"><a href="http://wpa.qq.com/msgrd?v=3&uin=2355263776&site=qq&menu=yes" target="_blank" class="qq">网站客服</a><a href="http://wpa.qq.com/msgrd?v=3&uin=2251809102&site=qq&menu=yes" target="_blank" class="qq">杂志客服</a><a href="http://e.weibo.com/csdnsupport/profile" target="_blank" class="weibo">微博客服</a><a href="mailto:webmaster@csdn.net" class="email" title="联系邮箱">webmaster@csdn.net</a><span class="phone" title="服务热线">400-600-2320</span><span class="interval">|</span><span>北京创新乐知信息技术有限公司 版权所有</span><span class="interval">|</span><span>江苏乐知网络技术有限公司 提供商务支持</span></dd><dd class="foot_copyright"><span>京&nbsp;ICP&nbsp;证&nbsp;070598&nbsp;号</span><span class="interval">|</span><span>Copyright © 1999-2014, CSDN.NET, All Rights Reserved&nbsp;</span><a href="http://www.hd315.gov.cn/beian/view.asp?bianhao=010202001032100010" target="_blank"><img src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/gongshang_logos.gif" alt="GongshangLogo" title=""></a></dd></dl></div></div><div id="note1" class="csdn_note" style="display:none; position:absolute; z-index:9999; width:440px">  <span class="notice_top_arrow"><span class="inner"></span></span>  <div class="box"></div></div><div class="csdn_notice_tip" style="display: none; position: absolute; z-index: 9990; width: 170px;">  <iframe src="about:blank" frameborder="0" scrolling="no" style="z-index:-1;position:absolute;top:0;left:0;width:100%;height:100%;background:transparent"></iframe>  <div class="tip_text">您有<strong>0</strong>条新通知</div>  <a href="javascript:void 0" class="close2"></a></div><script id="noticeScript" type="text/javascript" btnid="header_notice_num" wrapid="note1" count="5" subcount="5" src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/notify.js"></script>

    <script type="text/javascript" src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/login.js"></script>
<script type="text/javascript">document.write("<img src=http://counter.csdn.net/pv.aspx?id=24 border=0 width=0 height=0>");</script><img src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/pv.aspx" border="0" width="0" height="0">
<script type="text/javascript" src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/counter.js"></script><script type="text/javascript" charset="UTF-8" src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/msg.popup.js"></script>
<script type="text/javascript" src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/ad-blog.js"></script>
<script type="text/javascript" src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/count.js"></script><iframe src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/logs.htm" frameborder="0" width="0" height="0"></iframe>
<script type="text/javascript">
    $(function () {
        function __get_code_toolbar(snippet_id) {
            return $("<a href='https://code.csdn.net/snippets/"
                    + snippet_id
                    + "' target='_blank' title='在CODE上查看代码片' style='text-indent:0;'><img src='https://code.csdn.net/assets/CODE_ico.png' width=12 height=12 alt='在CODE上查看代码片' style='position:relative;top:1px;left:2px;'/></a>"
                    + "<a href='https://code.csdn.net/snippets/"
                    + snippet_id
                    + "/fork' target='_blank' title='派生到我的代码片'  style='text-indent:0;'><img src='https://code.csdn.net/assets/ico_fork.svg' width=12 height=12 alt='派生到我的代码片' style='position:relative;top:2px;left:2px;'/></a>");
        }
        
        $("[code_snippet_id]").each(function () {
            __s_id = $(this).attr("code_snippet_id");
            if (__s_id != null && __s_id != "" && __s_id != 0 && parseInt(__s_id) > 70020) {
                __code_tool = __get_code_toolbar(__s_id);
                $(this).prev().find(".tools").append(__code_tool);
            }
        });
    });
</script>




    </div><input type="hidden" id="aa_g_data_ids">
      <!--new top-->
    
    <script id="csdn-toolbar-id" btnid="header_notice_num" wrapid="note1" count="5" subcount="5" type="text/javascript" src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/toolbar.js"></script>
     <!--new top-->
   
    <link href="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/ask_float_block.css" type="text/css" rel="stylesheet">
    <script language="JavaScript" type="text/javascript" src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/wmd.js"></script>
    <script language="JavaScript" type="text/javascript" src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/showdown.js"></script>
    <script language="JavaScript" type="text/javascript" src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/prettify.js"></script>
    <script language="JavaScript" type="text/javascript" src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/ask_float_block.js"></script>



<div id="tag-suggest-pop">
  <div class="relative">
    <div class="close"></div>
    <div class="content"></div>
  </div>
</div><link rel="stylesheet" type="text/css" media="screen" href="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/ask_float_fonts_css-6b30a53970eb5c3a2a045e3df585b475.css"><div data-mod="popu_64" class="tracking-ad" chg-blk="0"><a id="com-ask-float-block" title="提问按钮" style="top:420px"></a><a id="com-quick-reply" title="快速回复" style="top:461px"></a><a id="com-d-top-a" style="top: 502px; display: inline;" title="返回顶部" onclick=""></a> </div><div class="pop_edit ask_second comm_ask_second"><h3>提问</h3><span class="ask_float_span">您的问题将会被发布在“<a class="ask_float_channel" href="http://ask.csdn.net/" target="_blank" style="cursor:pointer">技术问答</a>”频道</span><a href="http://blog.csdn.net/lionzl/article/details/7735483#" nodetype="close" class="close">×</a><div class="context"><div class="err_div"><span class="err_ico"></span><span class="err_txt">该问题已存在，请勿重复提问</span></div><div class="input_div"><input id="askInputSecond" type="text" style="font-size:14px;" placeholder="问题标题"></div><div class="cm_box"><div class="cm_dialog"></div> <div class="pop_cm cm_add_link"><input type="text" placeholder="链接内容" id="af_cm_link_txt"><input type="text" placeholder="链接地址" id="af_cm_link_url"><input type="text" placeholder="链接提示" id="af_cm_link_tit"><div class="text-right"><span class="btn btn-default btn-sm" id="add_link_btn">插入链接</span> </div> </div><div class="pop_cm cm_add_img"><div class="nav-tabs"><a class="img_tab active" href="http://blog.csdn.net/lionzl/article/details/7735483#tab_upload">本地上传</a><a class="img_tab" href="http://blog.csdn.net/lionzl/article/details/7735483#tab_weburl">网络图片</a></div><div class="tab_panel active" id="tab_upload"><div class="set_img"><iframe src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/upload.htm"></iframe></div></div><div class="tab_panel" id="tab_weburl"><input type="text" placeholder="图片地址" id="af_cm_img_url"><input type="text" placeholder="图片说明" id="af_cm_img_alt"><div class="text-right"><span class="btn btn-default btn-sm" id="add_img_btn">插入图片</span> </div></div> </div></div> <textarea id="editor_all" rows="8" style="display: none;"></textarea><div class="editor-toolbar"><i class="separator">|</i><a class="icon-headline" title="标题一（Ctrl+Alt+1）"></a><a class="icon-heading" title="标题二（Ctrl+Alt+2）"></a><a class="icon-bold" title="粗体（Ctrl+B）"></a><a class="icon-italic" title="斜体（Ctrl+I）"></a><i class="separator">|</i><a class="icon-quote-left" title="引用（Ctrl+’）"></a><a class="icon-code" title="插入代码片（Ctrl+,）"></a><a class="icon-list-ul" title="无序列表（Ctrl+L）"></a><a class="icon-list-ol" title="有序列表（Ctrl+Alt+L）"></a><i class="separator">|</i><a class="icon-link" title="添加链接（Ctrl+K）"></a><a class="icon-picture" title="添加图片（Ctrl+Alt+I）"></a><i class="separator">|</i><a class="icon-reply" title="撤退（Ctrl+Z）"></a><a class="icon-share-alt" title="前进（Ctrl+Shift+Z）"></a><i class="separator">|</i><a class="icon-info" href="http://ask.csdn.net/pages/markdown" target="_blank" title="markdown语法参考"></a><a class="icon-preview" title="预览"></a><i class="separator">|</i></div><div class="CodeMirror cm-s-paper CodeMirror-focused"><div style="overflow: hidden; position: relative; width: 3px; height: 0px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none; font-size: 4px;"></textarea></div><div class="CodeMirror-hscrollbar"><div style="height: 1px;"></div></div><div class="CodeMirror-vscrollbar"><div style="width: 1px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="min-width: 33px;"><div style="position: relative;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre>&nbsp;<span style="display: inline-block; width: 1px; margin-right: -1px;">&nbsp;</span></pre></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"></div><div class="CodeMirror-cursor" style="visibility: hidden;">&nbsp;</div><div class="CodeMirror-cursor CodeMirror-secondarycursor" style="visibility: hidden;">&nbsp;</div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px;"></div><div class="CodeMirror-gutters" style="display: none;"></div></div></div><div class="editor-statusbar"><span class="lines">0</span><span class="words">0</span><span class="cursor">0:0</span></div><div class="div_tags clearfix"><div id="divSearchTags" class="tags_con"><input type="text"></div><input type="hidden" name="txtSearchTags"></div><div id="ask2_tagRecomm_div" class="drt_tagRecomm tracking-ad" data-mod="popu_73"><span class="drt_tit">推荐标签：</span></div></div><div class="success"><div class="left_area"><input id="chk_cb" type="checkbox"><span class="wyxs">我要悬赏</span><input id="cb_num" class="cb_num" readonly="true"><span class="phib_rii"><span> 币</span></span></div><a href="http://blog.csdn.net/lionzl/article/details/7735483#" nodetype="cancel" class="cancel">取消</a><a href="http://blog.csdn.net/lionzl/article/details/7735483#" nodetype="ok" class="ok">发布</a></div></div><div id="common_ask_div_sc" class="searchContainer"><div class="sTitle">可能存在类似的问题：</div><div class="sFooter"><a class="sFirstNewAsk">我想提一个新问题</a></div></div><style type="text/css" id="xnSmartBarCacheCSSID">

.baiduServiceBottomBar.noDis{display:none !important}.baiduServiceBottomBar.iphoneDevice>ul>li .count{font-size:10px;line-height:12px;height:12px;padding:0px 2px;top:-3px;right:-8px;box-sizing:border-box;font-family:Arial, Helvetica, sans-serif;text-shadow:none;outline:none}.baiduServiceBottomBar.hackIFrame iframe{top:0px;-webkit-transform:translateZ(5px);transform:translateZ(5px)}.baiduServiceBottomBar{overflow:visible;line-height:1;border-top:1px solid #c0c0c0;position:fixed;z-index:200;width:100%;bottom:0px;background-color:rgba(242,242,242,0.94);background-image:-moz-linear-gradient(rgba(248,248,248,0.94), rgba(242,242,242,0.94));background-image:-o-linear-gradient(rgba(248,248,248,0.94), rgba(242,242,242,0.94));background-image:-webkit-gradient(linear, left top, left bottom, color-stop(0, rgba(248,248,248,0.94)), color-stop(1, rgba(242,242,242,0.94)));background-image:-webkit-linear-gradient(rgba(248,248,248,0.94), rgba(242,242,242,0.94));background-image:-ms-linear-gradient(rgba(248,248,248,0.94), rgba(242,242,242,0.94));background-image:linear-gradient(rgba(248,248,248,0.94), rgba(242,242,242,0.94))}.baiduServiceBottomBar div{overflow:visible}.baiduServiceBottomBar div,.baiduServiceBottomBar span,.baiduServiceBottomBar object,.baiduServiceBottomBar iframe,.baiduServiceBottomBar h1,.baiduServiceBottomBar h2,.baiduServiceBottomBar h3,.baiduServiceBottomBar h4,.baiduServiceBottomBar h5,.baiduServiceBottomBar h6,.baiduServiceBottomBar p,.baiduServiceBottomBar a,.baiduServiceBottomBar em,.baiduServiceBottomBar img,.baiduServiceBottomBar b,.baiduServiceBottomBar i,.baiduServiceBottomBar dl,.baiduServiceBottomBar dt,.baiduServiceBottomBar dd,.baiduServiceBottomBar ol,.baiduServiceBottomBar ul,.baiduServiceBottomBar li,.baiduServiceBottomBar fieldset,.baiduServiceBottomBar form,.baiduServiceBottomBar label,.baiduServiceBottomBar table,.baiduServiceBottomBar caption,.baiduServiceBottomBar tbody,.baiduServiceBottomBar tfoot,.baiduServiceBottomBar thead,.baiduServiceBottomBar tr,.baiduServiceBottomBar th,.baiduServiceBottomBar td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline}.baiduServiceBottomBar p,.baiduServiceBottomBar div,.baiduServiceBottomBar h1,.baiduServiceBottomBar h2,.baiduServiceBottomBar h3,.baiduServiceBottomBar h4,.baiduServiceBottomBar h5,.baiduServiceBottomBar h6{-webkit-text-size-adjust:none}.baiduServiceBottomBar ul,.baiduServiceBottomBar li,.baiduServiceBottomBar a{vertical-align:middle}.baiduServiceBottomBar ol,.baiduServiceBottomBar ul{list-style:none;overflow:visible}.baiduServiceBottomBar .qingIcon{width:22px;height:22px;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAqCAMAAADs1AnaAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA4BpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1YTA3ZWU4Yy0yNTUzLTQzOTktOTliMC0wYTYxYzc3NjY1ZGYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QzI1MDJCODkzOENGMTFFNDg2NjdDNzU2MzQwOTc2NzUiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QzI1MDJCODgzOENGMTFFNDg2NjdDNzU2MzQwOTc2NzUiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4YzRhMmIzNy03ODM4LTQyZTMtODI4Yy1lYjc1OTQyNjQwZWQiIHN0UmVmOmRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDoyOGIzNTdlNi03NTM5LTExNzctODViNy1hYTQ4NGY2ZjI2ZWIiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4Wt27tAAABmFBMVEXvX2pvs+r/+/vnECDlAhP0kpnwZ3EOcM383uBkRIPmCBj96+z+9fb6z9L4vMDpKznoHCvyfIX2p6397O360NPtUl7rPUrmBxjrPkv83+H2pqz4vsL2qK7lARLnDx/sQE3oHSzyfoftU17ye4TwaHIBeNn+9PXnESHoGyqJh7ZYY6Wq0vNRZan7+fsQcc36ztEHdNQZhd5+u+zc7PrW6fnvZW/4+/7pKDZsVY+1GTsOcs/0lZxhcrB3t+shasH96erv9/34ub5DZK1PouVgca/qM0EOcs7pKjjhAhTp4utmXZr//PwGe9sMftwDetrnFybKvtTpLDrrO0joGSgvkeHtUFzLv9QXhN36zdDpIzLgAxb6+PvlAxS+FzaGv+3H4fddqecCd9hGneTA3vYUg93tUV0Dd9hWS47QCyPoIjGYyPDvXmk9ZbH0k5qv1fN7OG5iVZRVpebrOkegzfH1+v4MctDl8fsIfNshid+MiLXy+P3VCB/n4euslrj8/f+ISHnqLTv0j5Y2leLoITDg7/sAeNrlABH///9RYd6zAAAAiHRSTlP///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8AGLfWDwAAAZZJREFUeNrc1FV7wjAUBuDiDIr7cDbm7u7u7u7u7kb422spPU0F2PW+qyZ5nz5N0nOIuCD2/nqDcI7gD225SoSUan0aJFcpUCIKlTwVMpoQxGSURFoH4sWhFSHSokOC6CwkH1nNsPa9CI9mK4YMTpinPnm4OZ8dNRbNJZFerWQnk5u3qf306GA/GttsGaQQbJuKE46x/Aotnd/G6PQ9lhLctkM+/Gxe22JsSgjYS5jESM0WkLL3ARZFPBjpkI2xZO/iGSEGHXox8na0A685WaWXGYRfzvYMkIez5LIA/VwCGV2ri0uhm6p7MBt39DGKUfE8kK915kLESMaSymv2alOikdaneCbUXY39bqkQ78f9D+j4LyjQKY28wXEOITSrFSNPBKGVXheHkCsnj4/IMFOuig9ETEMhFGTjyBeChSCvpIYA2d0wGfiU84ozK4kSXYqJv7ZdUOYMkp9CmaOpBVHDSKCKSewrJVpPAmnw/Uo0MR7a1Uq3wwYOpWiHVJYLmxiUprFSeemJajK0aDoTXW67cO5XgAEAv5+0kJ0BN/wAAAAASUVORK5CYII=");margin:10px auto;background-size:100% 100%}.baiduServiceBottomBar .qingBtn{width:48px;height:48px;background-color:#f8f8f8;border:1px solid #ddd}.baiduServiceBottomBar .qingIcon,.baiduServiceBottomBar .qingBtn{display:block}.baiduServiceBottomBar *{vertical-align:middle;box-sizing:border-box}.baiduServiceBottomBar .baidu-xn-pop-parent{position:relative}.baiduServiceBottomBar .baidu-xn-pop-container{position:absolute;bottom:100%;display:none;z-index:-90;width:113%;background-color:rgba(255,255,255,0.94);background-image:-moz-linear-gradient(rgba(255,255,255,0.94), rgba(255,255,255,0.94));background-image:-o-linear-gradient(rgba(255,255,255,0.94), rgba(255,255,255,0.94));background-image:-webkit-gradient(linear, left top, left bottom, color-stop(0, rgba(255,255,255,0.94)), color-stop(1, rgba(255,255,255,0.94)));background-image:-webkit-linear-gradient(rgba(255,255,255,0.94), rgba(255,255,255,0.94));background-image:-ms-linear-gradient(rgba(255,255,255,0.94), rgba(255,255,255,0.94));background-image:linear-gradient(rgba(255,255,255,0.94), rgba(255,255,255,0.94));left:initial !important;margin-left:-7px;border:1px solid #c0c0c0;border-radius:2px;box-shadow:0px 0px 4px 1px rgba(0,0,0,0.12);margin-bottom:12px;-webkit-transform:scale(1)}.baiduServiceBottomBar .baidu-xn-pop-container ul,.baiduServiceBottomBar .baidu-xn-pop-container li{list-style:none}.baiduServiceBottomBar .baidu-xn-pop-container ul{padding:0px 9px;height:auto}.baiduServiceBottomBar .baidu-xn-pop-container ul>li:not(:last-of-type){border-bottom:1px solid #dddddd}.baiduServiceBottomBar .baidu-xn-pop-container li.vote{height:43px}.baiduServiceBottomBar .baidu-xn-pop-container ul>li{height:36px}.baiduServiceBottomBar .baidu-xn-pop-container ul>li a{padding:1px 0;font-size:14px}.baiduServiceBottomBar .baidu-xn-pop-container.show,.baiduServiceBottomBar .show>.baidu-xn-pop-container{display:block;z-index:-90}.baiduServiceBottomBar .noDis{display:none !important}.baiduServiceBottomBar a{text-decoration:none;color:#001526}.baiduServiceBottomBar>ul{display:-webkit-box;display:-ms-flexbox;display:-moz-box;display:box;width:100%;list-style-type:none;padding:0px;margin:0px;-webkit-box-pack:center;-webkit-box-align:center;box-pack:center;box-align:center;border:0 #fafafb solid;border-width:1px 0 0 1px}.baiduServiceBottomBar>ul>li{display:block;width:3em;-webkit-box-flex:1;flex:1;-ms-flex:1;-moz-box-flex:1;text-align:center;font-size:10px}.baiduServiceBottomBar>ul>li a{font-size:16px;padding:6px 0px 4px;display:inline-block;display:inline-block;width:100%;line-height:34px;height:43px;text-align:center}.baiduServiceBottomBar>ul>li a p>span.text-char{text-shadow:0 1px #fff}.baiduServiceBottomBar>ul>li .icon{width:18px;height:18px;display:block;margin:0px auto 4px;background-size:100% 100%;vertical-align:middle;position:relative}.baiduServiceBottomBar>ul>li .count-outer{position:relative;width:auto;display:inline-block;line-height:inherit}.baiduServiceBottomBar>ul>li .count{background-color:#f43b3b;color:#fff;border-radius:1px;padding:0px 2px;position:absolute;font-size:10px;line-height:12px;height:12px;top:-3px;right:-10px;font-style:normal;text-shadow:none;outline:none}.baiduServiceBottomBar>ul>li .baidu-xn-pop-container .count{top:3px}.baiduServiceBottomBar>ul li.showMoreBtn{display:none;position:relative}.baiduServiceBottomBar>ul .comment .count{right:-9px}.baiduServiceBottomBar>ul .pop-tip{-webkit-transform:rotateZ(45deg);transform:rotateZ(45deg);width:6px;height:6px;z-index:300;top:-15px;left:-55%;position:absolute;border:1px solid #c0c0c0;background-color:rgba(255,255,255,0.94);display:none}.baiduServiceBottomBar>ul .pop-tip.align-right{margin-left:100%;border-left:0px;border-top:0px}@media only screen and (max-width: 400px){.baiduServiceBottomBar .show-more-buttons>li:nth-of-type(n+4),.baiduServiceBottomBar .show-more-buttons-lg>li:nth-of-type(n+4){display:none}.baiduServiceBottomBar .show-more-buttons>li.showMoreBtn,.baiduServiceBottomBar .show-more-buttons-lg>li.showMoreBtn{display:block}}@media only screen and (min-width: 400px) and (max-width: 480px){.baiduServiceBottomBar .show-more-buttons-lg>li:nth-of-type(n+5){display:none}.baiduServiceBottomBar .show-more-buttons-lg>li.showMoreBtn{display:block}}@media only screen and (max-device-width: 600px){.baiduServiceBottomBar #mobile-phone-detector{display:block}}.baiduServiceBottomBar [data-action=ecomBottomBar-vote]{position:relative}.baiduServiceBottomBar [data-action=ecomBottomBar-vote] .bd_vote{position:absolute;z-index:1;height:100%;width:100%;top:0px}.baiduServiceBottomBar [data-action=ecomBottomBar-vote] .text-char{display:inline-block;-webkit-transform:translateZ(0px);transform:translateZ(0px)}.baiduServiceBottomBar [data-action=ecomBottomBar-vote] .bd_vote iframe{position:relative}.baiduServiceBottomBar>ul>li:last-of-type .baidu-xn-pop-container{right:10px}.baiduServiceBottomBar>ul>li:first-of-type .baidu-xn-pop-container{left:8px !important;margin-left:0px}.baiduServiceBottomBar .baidu-xn-pop-parent:after{position:absolute;top:0px;left:50%;width:12px;height:3px;-webkit-box-sizing:border-box;box-sizing:border-box;border:1px solid #c0c0c0;border-left:0px;border-right:0px;margin:6px 0px 6px -6px;content:""}.baiduServiceBottomBar .qingBtn{display:none}.baiduServiceBottomBar.showQingIconStyle.hideContent{border-top:transparent;width:auto}.baiduServiceBottomBar.showQingIconStyle.hideContent .qingBtn{display:block}.baiduServiceBottomBar.showQingIconStyle.hideContent .icon-container{display:none}.baiduServiceBottomBar.showQingIconStyle{display:-webkit-box;display:-ms-flexbox;display:-moz-box;-webkit-box-pack:center;-webkit-box-align:center;box-pack:center;box-align:center}.baiduServiceBottomBar.showQingIconStyle .qingBtn{display:block}.baiduServiceBottomBar.showQingIconStyle>ul>li:first-of-type .baidu-xn-pop-container{left:initial !important;margin-left:-10%}.baiduServiceBottomBar.showQingIconStyle [data-action=ecomBottomBar-showMore]{max-width:50px}.baiduServiceBottomBar.showQingIconStyle [data-action=ecomBottomBar-showMore] .baidu-xn-pop-container{width:180%}.baiduServiceBottomBar.showQingIconStyle [data-action=ecomBottomBar-showMore] .pop-tip.align-right{margin-left:120%}.baiduServiceBottomBar.showQingIconStyle.showContent{width:100%}.baiduServiceBottomBar.showQingIconStyle.showContent .qingBtn{border:1px solid transparent;border-right:1px solid #cdcdcd}.baiduServiceBottomBar.showQingIconStyle.showContent .qingIcon{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAMAAACdt4HsAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NjRENkJCMzY0NkJGMTFFNEI4NTc5NjE5QjFBMjJERTQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NjRENkJCMzc0NkJGMTFFNEI4NTc5NjE5QjFBMjJERTQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo2NEQ2QkIzNDQ2QkYxMUU0Qjg1Nzk2MTlCMUEyMkRFNCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo2NEQ2QkIzNTQ2QkYxMUU0Qjg1Nzk2MTlCMUEyMkRFNCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PgNHqQMAAAA8UExURdLS0tzc3Onp6fj4+ExMTHt7e2xsbNXV1fz8/Hl5ef39/dTU1E1NTfn5+ejo6Nra2tPT0z8/PzMzM////3wYFWQAAAAUdFJOU/////////////////////////8AT0/nEQAAAT5JREFUeNrMl9sSgjAMRLcFRFFu6f//q1ekjLRJ3XHGvtI9QLpJEwRy4W8A3nUlss75DaBqRC6tXd9eRJp+BfQHua15suqn+b7/UL0BJ5ESwlMvcloAXqSEsOhF/AvgpISw6sW9AMe6gBDp6+MSg/NsJkT6+bwe42QlxBsRG8lI+NS/nWgi7OjXXDAQ9vRRMqmEXX2cjQphX79J5ywh9RDBRkg+gm1bGg3TizKfBsuv5oIDQ7CywUVQCfnjRdAIij2gWG7SDArNtJrBoaWNlmIIRkIqRRFshGSRQDAR0kUGlvKVK3O/A7C/wAaRPUbWSKyV2WRi05ktKGxJY4sqW9bZi4W92tjLlb3e2QaDbXHYJott89hGk2116WabbvfpgYMeeULFDl2Psa8uHfuqjROHsWzwHIe/m52/XlcBBgCFdCWM9zfnWwAAAABJRU5ErkJggg==)}.baiduServiceBottomBar.showQingIconStyle.showContent .icon-container{display:-webkit-box;display:-ms-flexbox;display:-moz-box;dislay:box;-webkit-box-flex:1;flex:1;-ms-flex:1;-moz-box-flex:1}.baiduServiceBottomBar.double-scale>ul>li a{line-height:68px;height:86px;font-size:32px;padding:12px 0 4px}.baiduServiceBottomBar.double-scale>ul>li .baidu-xn-pop-container{width:113%}.baiduServiceBottomBar.double-scale>ul>li .baidu-xn-pop-container ul{padding:0px 18px}.baiduServiceBottomBar.double-scale>ul>li .baidu-xn-pop-container ul>li{height:72px;line-height:60px;width:100%}.baiduServiceBottomBar.double-scale>ul>li .baidu-xn-pop-container ul>li a{padding:0px;line-height:72px;height:72px}.baiduServiceBottomBar.double-scale>ul>li .count{font-size:20px;line-height:20px;height:20px;padding:0 6px;top:6px;right:-20px;text-shadow:none;outline:none;border-radius:4px}.baiduServiceBottomBar.double-scale .baidu-xn-pop-parent:after{width:24px;height:6px;margin:12px 0 12px -12px;content:""}@media only screen and (max-width: 800px){.baiduServiceBottomBar.double-scale .show-more-buttons>li:nth-of-type(n+4),.baiduServiceBottomBar.double-scale .show-more-buttons-lg>li:nth-of-type(n+4){display:none}.baiduServiceBottomBar.double-scale .show-more-buttons>li.showMoreBtn,.baiduServiceBottomBar.double-scale .show-more-buttons-lg>li.showMoreBtn{display:block}}@media only screen and (min-width: 800px) and (max-width: 960px){.baiduServiceBottomBar.double-scale .show-more-buttons-lg>li:nth-of-type(n+5){display:none}.baiduServiceBottomBar.double-scale .show-more-buttons-lg>li.showMoreBtn{display:block}}.smb-user-guide-wrapper{position:fixed;z-index:9999;background:rgba(15,15,15,0.8);top:83px;width:238px;height:195px;left:50%;margin-left:-119px;border-radius:10px;font-size:14px;font-family:sans-serif}.smb-user-guide-wrapper .bg-pic{margin-top:24px;height:131px;background:url(//m.baidu.com/static/search/siteapp/lego/use_guide.png) center no-repeat;background-size:208px 131px}.smb-user-guide-wrapper .queryX{position:absolute;left:44px;top:90px}.smb-user-guide-wrapper .closeX{display:block;margin:8px auto;color:#fff;width:110px;height:25px;line-height:25px;text-align:center}.baiduServiceBottomBar-toast-container{position:fixed;z-index:99999999;width:100%;bottom:50px;text-align:center}.baiduServiceBottomBar-toast-container .toast-text{min-width:40%;max-width:80%;overflow:hidden;word-break:break-all;word-wrap:nowrap;text-overflow:ellipsis;background-color:rgba(0,0,0,0.75);opacity:0;-webkit-transition:opacity 2s linear 0s;border-radius:5px;color:#fff;padding:10px;margin:0px auto;font-size:16px}.baiduServiceBottomBar-toast-container.show .toast-text{opacity:1}.baiduServiceBottomBar-toast-container.noDis{display:none !important}body,html{padding:0px;margin:0px}

/**
 * 用于将 css 以内联 js 的形式插入到页面中去
 */
</style><script type="text/javascript" charset="utf-8" src="http://127.0.0.1:7777/getcuid?callback=xnJSONP048792" defer=""></script><div class="baiduServiceBottomBar noDis"><a class="qingBtn" data-action="ecomBottomBar-iconBtn" onclick="javascript:void(0);"><i class="qingIcon"></i></a><ul class="showCount-3 icon-container"><li><a data-action="ecomBottomBar-comment" onclick="javascript:void(0);" class="hackTJMark"><p class="count-outer"><span class="text-char">评价</span><span class="count" style="right: 0px;">21</span></p></a></li><li><a data-action="qingBottomBarShare" onclick="javascript:void(0);"><p class="count-outer"><span class="text-char">分享</span><span class="count noDis"></span></p></a></li><li><a data-action="ecomBottomBar-vote" onclick="javascript:void(0);"><p class="count-outer"><span class="text-char">赞</span><span class="count" style="right: 0px;">220</span></p><div class="bd_vote" data-inited="1"><iframe id="vote14299668453333" style="border: none; width: 100%; height: 100%; display: block;" src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/like.htm"></iframe></div></a></li><li class="showMoreBtn baidu-xn-pop-parent" data-action="ecomBottomBar-showMore"><a onclick="javascript:void(0);">更多</a><div class="noDis"><div class="baidu-xn-pop-container"><div class="pop-content"><ul></ul></div></div><div class="pop-tip align-right"></div></div></li></ul><!-- hack form mobile phone detect --><span id="mobile-phone-detector"></span></div><script type="text/javascript" charset="utf-8" src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/info" defer=""></script><script type="text/javascript" charset="utf-8" src="./Hook Shadow SSDT - lionzl的专栏 - 博客频道 - CSDN.NET_files/vote.js" async=""></script></body><style type="text/css" id="3406933000"></style></html>